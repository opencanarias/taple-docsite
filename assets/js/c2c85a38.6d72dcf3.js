"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[4446],{3905:(e,n,t)=>{t.d(n,{Zo:()=>g,kt:()=>I});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},g=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,l=e.originalType,s=e.parentName,g=i(e,["components","mdxType","originalType","parentName"]),d=c(t),I=o,m=d["".concat(s,".").concat(I)]||d[I]||p[I]||l;return t?a.createElement(m,r(r({ref:n},g),{},{components:t})):a.createElement(m,r({ref:n},g))}));function I(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var l=t.length,r=new Array(l);r[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,r[1]=i;for(var c=2;c<l;c++)r[c]=t[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},75814:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var a=t(87462),o=(t(67294),t(3905));const l={},r="Setting up the network",i={unversionedId:"build/access-control/setting-network",id:"version-0.2/build/access-control/setting-network",title:"Setting up the network",description:"Next, we will proceed to form the network with the elements seen in the previous section.",source:"@site/versioned_docs/version-0.2/build/access-control/setting-network.md",sourceDirName:"build/access-control",slug:"/build/access-control/setting-network",permalink:"/taple-docsite/docs/0.2/build/access-control/setting-network",draft:!1,tags:[],version:"0.2",lastUpdatedAt:1698670821,formattedLastUpdatedAt:"Oct 30, 2023",frontMatter:{},sidebar:"buildSidebar",previous:{title:"Build the use case",permalink:"/taple-docsite/docs/0.2/build/access-control/build-case"},next:{title:"Interacting with the network",permalink:"/taple-docsite/docs/0.2/build/access-control/interacting-network"}},s={},c=[{value:"Running a nodes",id:"running-a-nodes",level:2},{value:"Rental Company node",id:"rental-company-node",level:3},{value:"Cleaning Company node",id:"cleaning-company-node",level:3},{value:"Security Company node",id:"security-company-node",level:3},{value:"Vehicle node",id:"vehicle-node",level:3},{value:"Creating and updating governance",id:"creating-and-updating-governance",level:2},{value:"Creating governance",id:"creating-governance",level:3},{value:"Updating governance",id:"updating-governance",level:3},{value:"Creating subject and transferring ownership",id:"creating-subject-and-transferring-ownership",level:2},{value:"Creation of the subject",id:"creation-of-the-subject",level:3},{value:"Subject transfer",id:"subject-transfer",level:3}],g={toc:c};function p(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,a.Z)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"setting-up-the-network"},"Setting up the network"),(0,o.kt)("p",null,"Next, we will proceed to form the network with the elements seen in the previous section."),(0,o.kt)("h2",{id:"running-a-nodes"},"Running a nodes"),(0,o.kt)("p",null,"To start with the use case, the first thing we will do is to raise the necessary nodes for it. To do this, you must execute the various commands presented in the following sections."),(0,o.kt)("p",null,"Before raising the nodes, make sure to download the appropriate ",(0,o.kt)("strong",{parentName:"p"},"TAPLE Client")," image from Dockerhub:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker pull opencanarias/taple-client:0.2\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"In this tutorial, we are going to raise several nodes on the same local network, using the IP addresses assigned by docker. Note that these may not be exactly the same as the ones you get and you may need to change them. Also, we will raise each node on a different p2p and http port.")),(0,o.kt)("h3",{id:"rental-company-node"},"Rental Company node"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},"docker run \\\n    -p 3000:3000 \\\n    -p 50000:50000 \\\n    -e TAPLE_HTTP=true \\\n    -e TAPLE_ID_PRIVATE_KEY=74c417de2174f3a76b0b98343cea3aa35bfd3860cac8bf470092c3e751745c1a \\\n    -e TAPLE_NETWORK_LISTEN_ADDR=/ip4/0.0.0.0/tcp/50000 \\\n    opencanarias/taple-client:0.2\n")),(0,o.kt)("h3",{id:"cleaning-company-node"},"Cleaning Company node"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Cleaning Company"',title:'"Node:',Cleaning:!0,'Company"':!0},"docker run \\\n    -p 3001:3000 \\\n    -p 50001:50000 \\\n    -e TAPLE_HTTP=true \\\n    -e TAPLE_ID_PRIVATE_KEY=4f0e3c9cd24ab3420b81220bb7ebccb4e42501d3667dea81838b3bfaae20c936 \\\n    -e TAPLE_NETWORK_LISTEN_ADDR=/ip4/0.0.0.0/tcp/50001 \\\n    -e TAPLE_NETWORK_KNOWN_NODE=/ip4/172.17.0.1/tcp/50000/p2p/12D3KooWHHjN5vKSKeCWiBG3gHaDRDp6YzsEgu9iTesYqrWxAgFk \\\n    opencanarias/taple-client:0.2\n")),(0,o.kt)("h3",{id:"security-company-node"},"Security Company node"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Security Company"',title:'"Node:',Security:!0,'Company"':!0},"docker run \\\n    -p 3002:3000 \\\n    -p 50002:50000 \\\n    -e TAPLE_HTTP=true \\\n    -e TAPLE_ID_PRIVATE_KEY=6d3103185146ecedd28d3759df693999927e69aacb55e1aa9fe7ac17555da81c \\\n    -e TAPLE_NETWORK_LISTEN_ADDR=/ip4/0.0.0.0/tcp/50002 \\\n    -e TAPLE_NETWORK_KNOWN_NODE=/ip4/172.17.0.1/tcp/50000/p2p/12D3KooWHHjN5vKSKeCWiBG3gHaDRDp6YzsEgu9iTesYqrWxAgFk \\\n    opencanarias/taple-client:0.2\n")),(0,o.kt)("h3",{id:"vehicle-node"},"Vehicle node"),(0,o.kt)("p",null,"In this use case, we would have one node per vehicle, but to simplify the example, we will limit the use case to the interaction with one vehicle."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Vehicle"',title:'"Node:','Vehicle"':!0},"docker run \\\n    -p 3003:3000 \\\n    -p 50003:50000 \\\n    -e TAPLE_HTTP=true \\\n    -e TAPLE_ID_PRIVATE_KEY=2a71a0aff12c2de9e21d76e0538741aa9ac6da9ff7f467cf8b7211bd008a3198 \\\n    -e TAPLE_NETWORK_LISTEN_ADDR=/ip4/0.0.0.0/tcp/50003 \\\n    -e TAPLE_NETWORK_KNOWN_NODE=/ip4/172.17.0.1/tcp/50000/p2p/12D3KooWHHjN5vKSKeCWiBG3gHaDRDp6YzsEgu9iTesYqrWxAgFk \\\n    opencanarias/taple-client:0.2\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"It should be noted that for the node survey, we have previously generated the cryptographic material using the ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/taple-docsite/docs/0.2/learn/client-tools#taple-keygen"},"TAPLE Keygen"))," tool.")),(0,o.kt)("h2",{id:"creating-and-updating-governance"},"Creating and updating governance"),(0,o.kt)("p",null,"Once we have raised all the nodes, we proceed to the network configuration. For this, the creation of the governance is required. As the rental company is the owner of the use case, it is necessary that the creation of the governance is done by this entity. The steps necessary for its creation and updating will be described below."),(0,o.kt)("h3",{id:"creating-governance"},"Creating governance"),(0,o.kt)("p",null,"To begin, we create the governance by executing the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},'curl \'http://localhost:3000/api/event-requests\' \\\n    --header \'Content-Type: application/json\' \\\n    --data \'{\n      "request": {\n        "Create": {\n            "governance_id": "",\n            "schema_id": "governance",\n            "namespace": "",\n            "name": "Access_control"\n        }\n      }\n    }\'\n')),(0,o.kt)("p",null,'Once the above command is executed, the "',(0,o.kt)("strong",{parentName:"p"},"request-id"),'" of the event will be returned. It is necessary to save it for future steps.'),(0,o.kt)("p",null,"Once created, we check that the governance has been created successfully. To do this, we execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},"curl 'http://localhost:3000/api/event-requests/{{REQUEST-ID}}/state'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{REQUEST-ID}}")," with the value copied above.")),(0,o.kt)("p",null,"This last command, will provide a response like the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'{\n  "id": {{REQUEST-ID}},\n  "subject_id": {{GOVERNANCE-ID}},\n  "sn": 0,\n  "state": "finished",\n  "success": true\n}\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note:"),' Save the "',(0,o.kt)("strong",{parentName:"p"},"subject_id"),'" corresponding to the governance, as it will be needed in the next steps of the tutorial.'),(0,o.kt)("p",null,"Finally, to check the governance, we must execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},"curl 'http://localhost:3000/api/subjects/{{GOVERNANCE-ID}}'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{GOVERNANCE-ID}}")," with the previously saved governance hash identifier.")),(0,o.kt)("p",null,"Once our governance is initialized we can start formalizing the access control use case. However, the current governance is empty, so we must make updates to it to adapt it to our use case."),(0,o.kt)("h3",{id:"updating-governance"},"Updating governance"),(0,o.kt)("p",null,"Based on the initial governance previously seen:"),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Initial JSON governance"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "members": [],\n  "policies": [\n    {\n      "approve": {\n        "quorum": "MAJORITY"\n      },\n      "evaluate": {\n        "quorum": "MAJORITY"\n      },\n      "id": "governance",\n      "validate": {\n        "quorum": "MAJORITY"\n      }\n    }\n  ],\n  "roles": [\n    {\n      "namespace": "",\n      "role": "WITNESS",\n      "schema": {\n        "ID": "governance"\n      },\n      "who": "MEMBERS"\n    }\n  ],\n  "schemas": []\n}\n'))),(0,o.kt)("p",null,"and after filling in the corresponding fields, we would be left with the following:"),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Final JSON governance"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "members": [\n        {\n            "id": "EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs",\n            "name": "RentalCompany"\n        },\n        {\n            "id": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n            "name": "CleaningCompany"\n        },\n        {\n            "id": "EICgJYOXXRFqDMiFsrCcUgPYnCSgUT-zwe66LP8rDpPU",\n            "name": "SecurityCompany"\n        }\n    ],\n    "policies": [\n        {\n            "approve": {\n                "quorum": "MAJORITY"\n            },\n            "evaluate": {\n                "quorum": "MAJORITY"\n            },\n            "id": "governance",\n            "validate": {\n                "quorum": "MAJORITY"\n            }\n        },\n        {\n            "approve": {\n                "quorum": {\n                    "FIXED": 1\n                }\n            },\n            "evaluate": {\n                "quorum": "MAJORITY"\n            },\n            "id": "car",\n            "validate": {\n                "quorum": "MAJORITY"\n            }\n        }\n    ],\n    "roles": [\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": "MEMBERS"\n        },\n        {\n            "namespace": "",\n            "role": "CREATOR",\n            "schema": {\n                "ID": "car"\n            },\n            "who": {\n                "NAME": "RentalCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "car"\n            },\n            "who": {\n                "NAME": "RentalCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "car"\n            },\n            "who": {\n                "NAME": "RentalCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "ISSUER",\n            "schema": {\n                "ID": "car"\n            },\n            "who": {\n                "NAME": "RentalCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "CleaningCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "car"\n            },\n            "who": {\n                "NAME": "CleaningCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "car"\n            },\n            "who": {\n                "NAME": "CleaningCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "ISSUER",\n            "schema": {\n                "ID": "car"\n            },\n            "who": {\n                "NAME": "CleaningCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "SecurityCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "EVALUATOR",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "SecurityCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "car"\n            },\n            "who": {\n                "NAME": "SecurityCompany"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "ISSUER",\n            "schema": {\n                "ID": "car"\n            },\n            "who": "NOT_MEMBERS"\n        }\n    ],\n    "schemas": [\n        {\n            "contract": {\n                "raw":"dXNlIHNlcmRlOjp7RGVzZXJpYWxpemUsIFNlcmlhbGl6ZX07CnVzZSB0YXBsZV9zY19ydXN0IGFzIHNkazsKCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lKV0KZW51bSBTdGF0ZXNDYXIgewogICAgRlJFRSwKICAgIFJFTlRFRCwKfQoKI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUpXQpzdHJ1Y3QgUG9zaXRpb24gewogICAgbGF0aXR1ZGU6IGYzMiwKICAgIGxvbmdpdHVkZTogZjMyLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplLCBDbG9uZSldCnN0cnVjdCBDYXIgewogICAgcHViIHN0YXR1czogU3RhdGVzQ2FyLCAgICAgICAvLyBGUkVFIFJFTlRFRAogICAgcHViIGxhc3RfcG9zaXRpb246IFBvc2l0aW9uLCAvLyBsYXRpdHVkZSBsb25naXR1ZGUKfQoKI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSldCmVudW0gQ2FyRXZlbnQgewogICAgVW5yZW50YWwge30sCiAgICBSZW50IHt9LAogICAgT3BlbiB7fSwKICAgIFVwZGF0ZVBvc2l0aW9uIHsgbGF0aXR1ZGU6IGYzMiwgbG9uZ2l0dWRlOiBmMzIgfSwKfQoKI1tub19tYW5nbGVdCnB1YiB1bnNhZmUgZm4gbWFpbl9mdW5jdGlvbihzdGF0ZV9wdHI6IGkzMiwgZXZlbnRfcHRyOiBpMzIsIGlzX293bmVyOiBpMzIpIC0+IHUzMiB7CiAgICBzZGs6OmV4ZWN1dGVfY29udHJhY3Qoc3RhdGVfcHRyLCBldmVudF9wdHIsIGlzX293bmVyLCBjb250cmFjdF9sb2dpYykKfQoKZm4gY29udHJhY3RfbG9naWMoCiAgICBjb250ZXh0OiAmc2RrOjpDb250ZXh0PENhciwgQ2FyRXZlbnQ+LAogICAgY29udHJhY3RfcmVzdWx0OiAmbXV0IHNkazo6Q29udHJhY3RSZXN1bHQ8Q2FyPiwKKSB7CiAgICBsZXQgY2FyID0gJm11dCBjb250cmFjdF9yZXN1bHQuZmluYWxfc3RhdGU7CiAgICBtYXRjaCAmY29udGV4dC5ldmVudCB7CiAgICAgICAgQ2FyRXZlbnQ6OlVucmVudGFsIHt9ID0+IG1hdGNoIGNhci5zdGF0dXMgewogICAgICAgICAgICBTdGF0ZXNDYXI6OkZSRUUgPT4ge30KICAgICAgICAgICAgU3RhdGVzQ2FyOjpSRU5URUQgPT4gewogICAgICAgICAgICAgICAgY2FyLnN0YXR1cyA9IFN0YXRlc0Nhcjo6RlJFRTsKICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgQ2FyRXZlbnQ6OlJlbnQge30gPT4gbWF0Y2ggY2FyLnN0YXR1cyB7CiAgICAgICAgICAgIFN0YXRlc0Nhcjo6RlJFRSA9PiB7CiAgICAgICAgICAgICAgICBjYXIuc3RhdHVzID0gU3RhdGVzQ2FyOjpSRU5URUQ7CiAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU3RhdGVzQ2FyOjpSRU5URUQgPT4ge30KICAgICAgICB9LAogICAgICAgIENhckV2ZW50OjpPcGVuIHt9ID0+IHsKICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LmFwcHJvdmFsX3JlcXVpcmVkID0gdHJ1ZTsKICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LnN1Y2Nlc3MgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBDYXJFdmVudDo6VXBkYXRlUG9zaXRpb24gewogICAgICAgICAgICBsYXRpdHVkZSwKICAgICAgICAgICAgbG9uZ2l0dWRlLAogICAgICAgIH0gPT4gewogICAgICAgICAgICBjYXIubGFzdF9wb3NpdGlvbi5sYXRpdHVkZSA9IGxhdGl0dWRlLnJvdW5kKCk7CiAgICAgICAgICAgIGNhci5sYXN0X3Bvc2l0aW9uLmxvbmdpdHVkZSA9IGxvbmdpdHVkZS5yb3VuZCgpOwogICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgfQogICAgfQp9Cg=="\n            },\n            "id": "car",\n            "initial_value": {\n                "last_position": {\n                    "latitude": 0.0,\n                    "longitude": 0.0\n                },\n                "status": "FREE"\n            },\n            "schema": {\n                "additionalProperties": false,\n                "description": "State_of_car",\n                "properties": {\n                    "last_position": {\n                        "description": "Contains_the_record_of_the_last_position_of_the_car",\n                        "properties": {\n                            "latitude": {\n                                "description": "Define_the_latitude_of_the_car_geolocation",\n                                "type": "number"\n                            },\n                            "longitude": {\n                                "description": "Define_the_length_of_the_car_geolocation",\n                                "type": "number"\n                            }\n                        },\n                        "type": "object"\n                    },\n                    "status": {\n                        "description": "Defines_whether_the_car_is_free_or_rented",\n                        "enum": [\n                            "FREE",\n                            "RENTED"\n                        ],\n                        "type": "string"\n                    }\n                },\n                "required": [\n                    "status",\n                    "last_position"\n                ],\n                "type": "object"\n            }\n        }\n    ]\n}\n'))),(0,o.kt)("p",null,"To generate the above changes, we will use our ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/taple-docsite/docs/0.2/learn/client-tools#taple-patch"},"TAPLE-Patch"))," tool as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Another terminal"',title:'"Another','terminal"':!0},'taple-patch \'{"members":[],"policies":[{"approve":{"quorum":"MAJORITY"},"evaluate":{"quorum":"MAJORITY"},"id":"governance","validate":{"quorum":"MAJORITY"}}],"roles":[{"namespace":"","role":"WITNESS","schema":{"ID":"governance"},"who":"MEMBERS"}],"schemas":[]}\' \'{"members":[{"id":"EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs","name":"RentalCompany"},{"id":"Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI","name":"CleaningCompany"},{"id":"EICgJYOXXRFqDMiFsrCcUgPYnCSgUT-zwe66LP8rDpPU","name":"SecurityCompany"}],"policies":[{"approve":{"quorum":"MAJORITY"},"evaluate":{"quorum":"MAJORITY"},"id":"governance","validate":{"quorum":"MAJORITY"}},{"approve":{"quorum":{"FIXED":1}},"evaluate":{"quorum":"MAJORITY"},"id":"car","validate":{"quorum":"MAJORITY"}}],"roles":[{"namespace":"","role":"WITNESS","schema":{"ID":"governance"},"who":"MEMBERS"},{"namespace":"","role":"CREATOR","schema":{"ID":"car"},"who":{"NAME":"RentalCompany"}},{"namespace":"","role":"APPROVER","schema":{"ID":"car"},"who":{"NAME":"RentalCompany"}},{"namespace":"","role":"WITNESS","schema":{"ID":"car"},"who":{"NAME":"RentalCompany"}},{"namespace":"","role":"ISSUER","schema":{"ID":"car"},"who":{"NAME":"RentalCompany"}},{"namespace":"","role":"WITNESS","schema":{"ID":"governance"},"who":{"NAME":"CleaningCompany"}},{"namespace":"","role":"WITNESS","schema":{"ID":"car"},"who":{"NAME":"CleaningCompany"}},{"namespace":"","role":"APPROVER","schema":{"ID":"car"},"who":{"NAME":"CleaningCompany"}},{"namespace":"","role":"ISSUER","schema":{"ID":"car"},"who":{"NAME":"CleaningCompany"}},{"namespace":"","role":"WITNESS","schema":{"ID":"governance"},"who":{"NAME":"SecurityCompany"}},{"namespace":"","role":"EVALUATOR","schema":{"ID":"governance"},"who":{"NAME":"SecurityCompany"}},{"namespace":"","role":"WITNESS","schema":{"ID":"car"},"who":{"NAME":"SecurityCompany"}},{"namespace":"","role":"ISSUER","schema":{"ID":"car"},"who":"NOT_MEMBERS"}],"schemas":[{"contract":{"raw":"dXNlIHNlcmRlOjp7RGVzZXJpYWxpemUsIFNlcmlhbGl6ZX07CnVzZSB0YXBsZV9zY19ydXN0IGFzIHNkazsKCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lKV0KZW51bSBTdGF0ZXNDYXIgewogICAgRlJFRSwKICAgIFJFTlRFRCwKfQoKI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUpXQpzdHJ1Y3QgUG9zaXRpb24gewogICAgbGF0aXR1ZGU6IGYzMiwKICAgIGxvbmdpdHVkZTogZjMyLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplLCBDbG9uZSldCnN0cnVjdCBDYXIgewogICAgcHViIHN0YXR1czogU3RhdGVzQ2FyLCAgICAgICAvLyBGUkVFIFJFTlRFRAogICAgcHViIGxhc3RfcG9zaXRpb246IFBvc2l0aW9uLCAvLyBsYXRpdHVkZSBsb25naXR1ZGUKfQoKI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSldCmVudW0gQ2FyRXZlbnQgewogICAgVW5yZW50YWwge30sCiAgICBSZW50IHt9LAogICAgT3BlbiB7fSwKICAgIFVwZGF0ZVBvc2l0aW9uIHsgbGF0aXR1ZGU6IGYzMiwgbG9uZ2l0dWRlOiBmMzIgfSwKfQoKI1tub19tYW5nbGVdCnB1YiB1bnNhZmUgZm4gbWFpbl9mdW5jdGlvbihzdGF0ZV9wdHI6IGkzMiwgZXZlbnRfcHRyOiBpMzIsIGlzX293bmVyOiBpMzIpIC0+IHUzMiB7CiAgICBzZGs6OmV4ZWN1dGVfY29udHJhY3Qoc3RhdGVfcHRyLCBldmVudF9wdHIsIGlzX293bmVyLCBjb250cmFjdF9sb2dpYykKfQoKZm4gY29udHJhY3RfbG9naWMoCiAgICBjb250ZXh0OiAmc2RrOjpDb250ZXh0PENhciwgQ2FyRXZlbnQ+LAogICAgY29udHJhY3RfcmVzdWx0OiAmbXV0IHNkazo6Q29udHJhY3RSZXN1bHQ8Q2FyPiwKKSB7CiAgICBsZXQgY2FyID0gJm11dCBjb250cmFjdF9yZXN1bHQuZmluYWxfc3RhdGU7CiAgICBtYXRjaCAmY29udGV4dC5ldmVudCB7CiAgICAgICAgQ2FyRXZlbnQ6OlVucmVudGFsIHt9ID0+IG1hdGNoIGNhci5zdGF0dXMgewogICAgICAgICAgICBTdGF0ZXNDYXI6OkZSRUUgPT4ge30KICAgICAgICAgICAgU3RhdGVzQ2FyOjpSRU5URUQgPT4gewogICAgICAgICAgICAgICAgY2FyLnN0YXR1cyA9IFN0YXRlc0Nhcjo6RlJFRTsKICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgQ2FyRXZlbnQ6OlJlbnQge30gPT4gbWF0Y2ggY2FyLnN0YXR1cyB7CiAgICAgICAgICAgIFN0YXRlc0Nhcjo6RlJFRSA9PiB7CiAgICAgICAgICAgICAgICBjYXIuc3RhdHVzID0gU3RhdGVzQ2FyOjpSRU5URUQ7CiAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU3RhdGVzQ2FyOjpSRU5URUQgPT4ge30KICAgICAgICB9LAogICAgICAgIENhckV2ZW50OjpPcGVuIHt9ID0+IHsKICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LmFwcHJvdmFsX3JlcXVpcmVkID0gdHJ1ZTsKICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LnN1Y2Nlc3MgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBDYXJFdmVudDo6VXBkYXRlUG9zaXRpb24gewogICAgICAgICAgICBsYXRpdHVkZSwKICAgICAgICAgICAgbG9uZ2l0dWRlLAogICAgICAgIH0gPT4gewogICAgICAgICAgICBjYXIubGFzdF9wb3NpdGlvbi5sYXRpdHVkZSA9IGxhdGl0dWRlLnJvdW5kKCk7CiAgICAgICAgICAgIGNhci5sYXN0X3Bvc2l0aW9uLmxvbmdpdHVkZSA9IGxvbmdpdHVkZS5yb3VuZCgpOwogICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgfQogICAgfQp9Cg=="},"id":"car","initial_value":{"last_position":{"latitude":0.0,"longitude":0.0},"status":"FREE"},"schema":{"additionalProperties":false,"description":"State_of_car","properties":{"last_position":{"description":"Contains_the_record_of_the_last_position_of_the_car","properties":{"latitude":{"description":"Define_the_latitude_of_the_car_geolocation","type":"number"},"longitude":{"description":"Define_the_length_of_the_car_geolocation","type":"number"}},"type":"object"},"status":{"description":"Defines_whether_the_car_is_free_or_rented","enum":["FREE","RENTED"],"type":"string"}},"required":["status","last_position"],"type":"object"}}]}\'\n')),(0,o.kt)("p",null,"You should then get the following output:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Another terminal"',title:'"Another','terminal"':!0},'[\n  {\n    "op": "add",\n    "path": "/members/0",\n    "value": {\n      "id": "EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs",\n      "name": "RentalCompany"\n    }\n  },\n  {\n    "op": "add",\n    "path": "/members/1",\n    "value": {\n      "id": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n      "name": "CleaningCompany"\n    }\n  },\n  {\n    "op": "add",\n    "path": "/members/2",\n    "value": {\n      "id": "EICgJYOXXRFqDMiFsrCcUgPYnCSgUT-zwe66LP8rDpPU",\n      "name": "SecurityCompany"\n    }\n  },\n  {\n    "op": "add",\n    "path": "/policies/1",\n    "value": {\n      "approve": {\n        "quorum": {\n          "FIXED": 1\n        }\n      },\n      "evaluate": {\n        "quorum": "MAJORITY"\n      },\n      "id": "car",\n      "validate": {\n        "quorum": "MAJORITY"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/1",\n    "value": {\n      "namespace": "",\n      "role": "CREATOR",\n      "schema": {\n        "ID": "car"\n      },\n      "who": {\n        "NAME": "RentalCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/2",\n    "value": {\n      "namespace": "",\n      "role": "APPROVER",\n      "schema": {\n        "ID": "car"\n      },\n      "who": {\n        "NAME": "RentalCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/3",\n    "value": {\n      "namespace": "",\n      "role": "WITNESS",\n      "schema": {\n        "ID": "car"\n      },\n      "who": {\n        "NAME": "RentalCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/4",\n    "value": {\n      "namespace": "",\n      "role": "ISSUER",\n      "schema": {\n        "ID": "car"\n      },\n      "who": {\n        "NAME": "RentalCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/5",\n    "value": {\n      "namespace": "",\n      "role": "WITNESS",\n      "schema": {\n        "ID": "governance"\n      },\n      "who": {\n        "NAME": "CleaningCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/6",\n    "value": {\n      "namespace": "",\n      "role": "WITNESS",\n      "schema": {\n        "ID": "car"\n      },\n      "who": {\n        "NAME": "CleaningCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/7",\n    "value": {\n      "namespace": "",\n      "role": "APPROVER",\n      "schema": {\n        "ID": "car"\n      },\n      "who": {\n        "NAME": "CleaningCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/8",\n    "value": {\n      "namespace": "",\n      "role": "ISSUER",\n      "schema": {\n        "ID": "car"\n      },\n      "who": {\n        "NAME": "CleaningCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/9",\n    "value": {\n      "namespace": "",\n      "role": "WITNESS",\n      "schema": {\n        "ID": "governance"\n      },\n      "who": {\n        "NAME": "SecurityCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/10",\n    "value": {\n      "namespace": "",\n      "role": "EVALUATOR",\n      "schema": {\n        "ID": "governance"\n      },\n      "who": {\n        "NAME": "SecurityCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/11",\n    "value": {\n      "namespace": "",\n      "role": "WITNESS",\n      "schema": {\n        "ID": "car"\n      },\n      "who": {\n        "NAME": "SecurityCompany"\n      }\n    }\n  },\n  {\n    "op": "add",\n    "path": "/roles/12",\n    "value": {\n      "namespace": "",\n      "role": "ISSUER",\n      "schema": {\n        "ID": "car"\n      },\n      "who": "NOT_MEMBERS"\n    }\n  }, \n  {\n    "op": "add",\n    "path": "/schemas/0",\n    "value": {\n      "contract": {\n        "raw": "dXNlIHNlcmRlOjp7RGVzZXJpYWxpemUsIFNlcmlhbGl6ZX07CnVzZSB0YXBsZV9zY19ydXN0IGFzIHNkazsKCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lKV0KZW51bSBTdGF0ZXNDYXIgewogICAgRlJFRSwKICAgIFJFTlRFRCwKfQoKI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUpXQpzdHJ1Y3QgUG9zaXRpb24gewogICAgbGF0aXR1ZGU6IGYzMiwKICAgIGxvbmdpdHVkZTogZjMyLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplLCBDbG9uZSldCnN0cnVjdCBDYXIgewogICAgcHViIHN0YXR1czogU3RhdGVzQ2FyLCAgICAgICAvLyBGUkVFIFJFTlRFRAogICAgcHViIGxhc3RfcG9zaXRpb246IFBvc2l0aW9uLCAvLyBsYXRpdHVkZSBsb25naXR1ZGUKfQoKI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSldCmVudW0gQ2FyRXZlbnQgewogICAgVW5yZW50YWwge30sCiAgICBSZW50IHt9LAogICAgT3BlbiB7fSwKICAgIFVwZGF0ZVBvc2l0aW9uIHsgbGF0aXR1ZGU6IGYzMiwgbG9uZ2l0dWRlOiBmMzIgfSwKfQoKI1tub19tYW5nbGVdCnB1YiB1bnNhZmUgZm4gbWFpbl9mdW5jdGlvbihzdGF0ZV9wdHI6IGkzMiwgZXZlbnRfcHRyOiBpMzIsIGlzX293bmVyOiBpMzIpIC0+IHUzMiB7CiAgICBzZGs6OmV4ZWN1dGVfY29udHJhY3Qoc3RhdGVfcHRyLCBldmVudF9wdHIsIGlzX293bmVyLCBjb250cmFjdF9sb2dpYykKfQoKZm4gY29udHJhY3RfbG9naWMoCiAgICBjb250ZXh0OiAmc2RrOjpDb250ZXh0PENhciwgQ2FyRXZlbnQ+LAogICAgY29udHJhY3RfcmVzdWx0OiAmbXV0IHNkazo6Q29udHJhY3RSZXN1bHQ8Q2FyPiwKKSB7CiAgICBsZXQgY2FyID0gJm11dCBjb250cmFjdF9yZXN1bHQuZmluYWxfc3RhdGU7CiAgICBtYXRjaCAmY29udGV4dC5ldmVudCB7CiAgICAgICAgQ2FyRXZlbnQ6OlVucmVudGFsIHt9ID0+IG1hdGNoIGNhci5zdGF0dXMgewogICAgICAgICAgICBTdGF0ZXNDYXI6OkZSRUUgPT4ge30KICAgICAgICAgICAgU3RhdGVzQ2FyOjpSRU5URUQgPT4gewogICAgICAgICAgICAgICAgY2FyLnN0YXR1cyA9IFN0YXRlc0Nhcjo6RlJFRTsKICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgQ2FyRXZlbnQ6OlJlbnQge30gPT4gbWF0Y2ggY2FyLnN0YXR1cyB7CiAgICAgICAgICAgIFN0YXRlc0Nhcjo6RlJFRSA9PiB7CiAgICAgICAgICAgICAgICBjYXIuc3RhdHVzID0gU3RhdGVzQ2FyOjpSRU5URUQ7CiAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU3RhdGVzQ2FyOjpSRU5URUQgPT4ge30KICAgICAgICB9LAogICAgICAgIENhckV2ZW50OjpPcGVuIHt9ID0+IHsKICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LmFwcHJvdmFsX3JlcXVpcmVkID0gdHJ1ZTsKICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LnN1Y2Nlc3MgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBDYXJFdmVudDo6VXBkYXRlUG9zaXRpb24gewogICAgICAgICAgICBsYXRpdHVkZSwKICAgICAgICAgICAgbG9uZ2l0dWRlLAogICAgICAgIH0gPT4gewogICAgICAgICAgICBjYXIubGFzdF9wb3NpdGlvbi5sYXRpdHVkZSA9IGxhdGl0dWRlLnJvdW5kKCk7CiAgICAgICAgICAgIGNhci5sYXN0X3Bvc2l0aW9uLmxvbmdpdHVkZSA9IGxvbmdpdHVkZS5yb3VuZCgpOwogICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgfQogICAgfQp9Cg=="\n      },\n      "id": "car",\n      "initial_value": {\n        "last_position": {\n          "latitude": 0.0,\n          "longitude": 0.0\n        },\n        "status": "FREE"\n      },\n      "schema": {\n        "additionalProperties": false,\n        "description": "State_of_car",\n        "properties": {\n          "last_position": {\n            "description": "Contains_the_record_of_the_last_position_of_the_car",\n            "properties": {\n              "latitude": {\n                "description": "Define_the_latitude_of_the_car_geolocation",\n                "type": "number"\n              },\n              "longitude": {\n                "description": "Define_the_length_of_the_car_geolocation",\n                "type": "number"\n              }\n            },\n            "type": "object"\n          },\n          "status": {\n            "description": "Defines_whether_the_car_is_free_or_rented",\n            "enum": [\n              "FREE",\n              "RENTED"\n            ],\n            "type": "string"\n          }\n        },\n        "required": [\n          "status",\n          "last_position"\n        ],\n        "type": "object"\n      }\n    }\n  }\n]\n')),(0,o.kt)("p",null,"Now, it will be necessary to issue a fact event to the governance to add this new information. To do this, we execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},'curl --request POST \'http://localhost:3000/api/event-requests\' \\\n    --header \'Content-Type: application/json\' \\\n    --data \'{\n        "request": {\n            "Fact": {\n                "subject_id": "{{GOVERNANCE-ID}}",\n                "payload": {\n                    "Patch": {\n                        "data": [\n                            {\n                                "op": "add",\n                                "path": "/members/0",\n                                "value": {\n                                  "id": "EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs",\n                                  "name": "RentalCompany"\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/members/1",\n                                "value": {\n                                  "id": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n                                  "name": "CleaningCompany"\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/members/2",\n                                "value": {\n                                  "id": "EICgJYOXXRFqDMiFsrCcUgPYnCSgUT-zwe66LP8rDpPU",\n                                  "name": "SecurityCompany"\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/policies/1",\n                                "value": {\n                                    "approve": {\n                                        "quorum": {\n                                            "FIXED": 1\n                                        }\n                                    },\n                                    "evaluate": {\n                                        "quorum": "MAJORITY"\n                                    },\n                                    "id": "car",\n                                    "validate": {\n                                        "quorum": "MAJORITY"\n                                    }\n                                }\n                            },  \n                            {\n                                "op": "add",\n                                "path": "/roles/1",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "CREATOR",\n                                    "schema": {\n                                        "ID": "car"\n                                    },\n                                    "who": {\n                                        "NAME": "RentalCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/2",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "APPROVER",\n                                    "schema": {\n                                        "ID": "car"\n                                    },\n                                    "who": {\n                                        "NAME": "RentalCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/3",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "WITNESS",\n                                    "schema": {\n                                      "ID": "car"\n                                    },\n                                    "who": {\n                                      "NAME": "RentalCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/4",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "ISSUER",\n                                    "schema": {\n                                      "ID": "car"\n                                    },\n                                    "who": {\n                                      "NAME": "RentalCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/5",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "WITNESS",\n                                    "schema": {\n                                      "ID": "governance"\n                                    },\n                                    "who": {\n                                      "NAME": "CleaningCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/6",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "WITNESS",\n                                    "schema": {\n                                      "ID": "car"\n                                    },\n                                    "who": {\n                                      "NAME": "CleaningCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/7",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "APPROVER",\n                                    "schema": {\n                                      "ID": "car"\n                                    },\n                                    "who": {\n                                      "NAME": "CleaningCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/8",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "ISSUER",\n                                    "schema": {\n                                      "ID": "car"\n                                    },\n                                    "who": {\n                                      "NAME": "CleaningCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/9",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "WITNESS",\n                                    "schema": {\n                                      "ID": "governance"\n                                    },\n                                    "who": {\n                                      "NAME": "SecurityCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/10",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "EVALUATOR",\n                                    "schema": {\n                                      "ID": "governance"\n                                    },\n                                    "who": {\n                                      "NAME": "SecurityCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/11",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "WITNESS",\n                                    "schema": {\n                                      "ID": "car"\n                                    },\n                                    "who": {\n                                      "NAME": "SecurityCompany"\n                                    }\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/roles/12",\n                                "value": {\n                                    "namespace": "",\n                                    "role": "ISSUER",\n                                    "schema": {\n                                      "ID": "car"\n                                    },\n                                    "who": "NOT_MEMBERS"\n                                }\n                            },\n                            {\n                                "op": "add",\n                                "path": "/schemas/0",\n                                "value": {\n                                  "contract": {\n                                    "raw": "dXNlIHNlcmRlOjp7RGVzZXJpYWxpemUsIFNlcmlhbGl6ZX07CnVzZSB0YXBsZV9zY19ydXN0IGFzIHNkazsKCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lKV0KZW51bSBTdGF0ZXNDYXIgewogICAgRlJFRSwKICAgIFJFTlRFRCwKfQoKI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUpXQpzdHJ1Y3QgUG9zaXRpb24gewogICAgbGF0aXR1ZGU6IGYzMiwKICAgIGxvbmdpdHVkZTogZjMyLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplLCBDbG9uZSldCnN0cnVjdCBDYXIgewogICAgcHViIHN0YXR1czogU3RhdGVzQ2FyLCAgICAgICAvLyBGUkVFIFJFTlRFRAogICAgcHViIGxhc3RfcG9zaXRpb246IFBvc2l0aW9uLCAvLyBsYXRpdHVkZSBsb25naXR1ZGUKfQoKI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSldCmVudW0gQ2FyRXZlbnQgewogICAgVW5yZW50YWwge30sCiAgICBSZW50IHt9LAogICAgT3BlbiB7fSwKICAgIFVwZGF0ZVBvc2l0aW9uIHsgbGF0aXR1ZGU6IGYzMiwgbG9uZ2l0dWRlOiBmMzIgfSwKfQoKI1tub19tYW5nbGVdCnB1YiB1bnNhZmUgZm4gbWFpbl9mdW5jdGlvbihzdGF0ZV9wdHI6IGkzMiwgZXZlbnRfcHRyOiBpMzIsIGlzX293bmVyOiBpMzIpIC0+IHUzMiB7CiAgICBzZGs6OmV4ZWN1dGVfY29udHJhY3Qoc3RhdGVfcHRyLCBldmVudF9wdHIsIGlzX293bmVyLCBjb250cmFjdF9sb2dpYykKfQoKZm4gY29udHJhY3RfbG9naWMoCiAgICBjb250ZXh0OiAmc2RrOjpDb250ZXh0PENhciwgQ2FyRXZlbnQ+LAogICAgY29udHJhY3RfcmVzdWx0OiAmbXV0IHNkazo6Q29udHJhY3RSZXN1bHQ8Q2FyPiwKKSB7CiAgICBsZXQgY2FyID0gJm11dCBjb250cmFjdF9yZXN1bHQuZmluYWxfc3RhdGU7CiAgICBtYXRjaCAmY29udGV4dC5ldmVudCB7CiAgICAgICAgQ2FyRXZlbnQ6OlVucmVudGFsIHt9ID0+IG1hdGNoIGNhci5zdGF0dXMgewogICAgICAgICAgICBTdGF0ZXNDYXI6OkZSRUUgPT4ge30KICAgICAgICAgICAgU3RhdGVzQ2FyOjpSRU5URUQgPT4gewogICAgICAgICAgICAgICAgY2FyLnN0YXR1cyA9IFN0YXRlc0Nhcjo6RlJFRTsKICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgQ2FyRXZlbnQ6OlJlbnQge30gPT4gbWF0Y2ggY2FyLnN0YXR1cyB7CiAgICAgICAgICAgIFN0YXRlc0Nhcjo6RlJFRSA9PiB7CiAgICAgICAgICAgICAgICBjYXIuc3RhdHVzID0gU3RhdGVzQ2FyOjpSRU5URUQ7CiAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU3RhdGVzQ2FyOjpSRU5URUQgPT4ge30KICAgICAgICB9LAogICAgICAgIENhckV2ZW50OjpPcGVuIHt9ID0+IHsKICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LmFwcHJvdmFsX3JlcXVpcmVkID0gdHJ1ZTsKICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LnN1Y2Nlc3MgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBDYXJFdmVudDo6VXBkYXRlUG9zaXRpb24gewogICAgICAgICAgICBsYXRpdHVkZSwKICAgICAgICAgICAgbG9uZ2l0dWRlLAogICAgICAgIH0gPT4gewogICAgICAgICAgICBjYXIubGFzdF9wb3NpdGlvbi5sYXRpdHVkZSA9IGxhdGl0dWRlLnJvdW5kKCk7CiAgICAgICAgICAgIGNhci5sYXN0X3Bvc2l0aW9uLmxvbmdpdHVkZSA9IGxvbmdpdHVkZS5yb3VuZCgpOwogICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgfQogICAgfQp9Cg=="\n                                  },\n                                  "id": "car",\n                                  "initial_value": {\n                                    "last_position": {\n                                      "latitude": 0.0,\n                                      "longitude": 0.0\n                                    },\n                                    "status": "FREE"\n                                  },\n                                  "schema": {\n                                    "additionalProperties": false,\n                                    "description": "State_of_car",\n                                    "properties": {\n                                      "last_position": {\n                                        "description": "Contains_the_record_of_the_last_position_of_the_car",\n                                        "properties": {\n                                          "latitude": {\n                                            "description": "Define_the_latitude_of_the_car_geolocation",\n                                            "type": "number"\n                                          },\n                                          "longitude": {\n                                            "description": "Define_the_length_of_the_car_geolocation",\n                                            "type": "number"\n                                          }\n                                        },\n                                        "type": "object"\n                                      },\n                                      "status": {\n                                        "description": "Defines_whether_the_car_is_free_or_rented",\n                                        "enum": [\n                                          "FREE",\n                                          "RENTED"\n                                        ],\n                                        "type": "string"\n                                      }\n                                    },\n                                    "required": [\n                                      "status",\n                                      "last_position"\n                                    ],\n                                    "type": "object"\n                                }\n                            }   \n                        }\n                    ]\n                }\n            }\n        }\n    }\n}\'\n')),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{GOVERNANCE-ID}}")," with the previously saved governance hash identifier.")),(0,o.kt)("p",null,"In governance, governance roles and policies are defined. By default, any change in governance requires the approval of the majority of members. At this point, the only one who will be asked for approval is the owner, since no members have been defined in the governance yet. Next, it will be necessary to obtain the new update request. To do this, we execute the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},"curl 'http://localhost:3000/api/approval-requests?status=Pending'\n")),(0,o.kt)("p",null,'Copy the value of the "id" field and accept the update request on the governance by executing the following command:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},"curl --request PATCH 'http://localhost:3000/api/approval-requests/{{PREVIUS-ID}}' \\\n    --header 'Content-Type: application/json' \\\n    --data-raw '{\"state\": \"RespondedAccepted\"}'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{PREVIUS-ID}}")," with the value copied from above.")),(0,o.kt)("p",null,'Finally, we will make a query to the governance to verify that the change has been made correctly. If everything has been done as planned, we should see how the "sn" field has increased in value and the members, the schema, the contract and the policies should appear. To do this, run the following command:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},"curl 'http://localhost:3000/api/subjects/{{GOVERNANCE-ID}}'\n")),(0,o.kt)("p",null,"Before continuing, in order for nodes that are members of the governance and are not owners of the governance, to be able to access and interact with the governance, we must grant prior permissions to the governance. To do this, we execute the following commands:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Cleaning Company"',title:'"Node:',Cleaning:!0,'Company"':!0},"curl --request PUT 'http://localhost:3001/api/allowed-subjects/{{GOVERNANCE-ID}}' \\\n    --header 'Content-Type: application/json' \\\n    --data-raw '{\n        \"providers\": []\n    }'\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Security Company"',title:'"Node:',Security:!0,'Company"':!0},"curl --request PUT 'http://localhost:3002/api/allowed-subjects/{{GOVERNANCE-ID}}' \\\n    --header 'Content-Type: application/json' \\\n    --data-raw '{\n        \"providers\": []\n    }'\n")),(0,o.kt)("p",null,"Finally, we consult the governance from the previously authorized nodes to verify that they have received the governance correctly. To do this, we execute the following commands:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Cleaning Company"',title:'"Node:',Cleaning:!0,'Company"':!0},"curl 'http://localhost:3001/api/subjects/{{GOVERNANCE-ID}}'\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Security Company"',title:'"Node:',Security:!0,'Company"':!0},"curl 'http://localhost:3002/api/subjects/{{GOVERNANCE-ID}}'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the above requests, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{GOVERNANCE-ID}}")," with the previously saved governance hash identifier.")),(0,o.kt)("h2",{id:"creating-subject-and-transferring-ownership"},"Creating subject and transferring ownership"),(0,o.kt)("h3",{id:"creation-of-the-subject"},"Creation of the subject"),(0,o.kt)("p",null,'At this point, we have everything we need to start creating subjects of type "',(0,o.kt)("strong",{parentName:"p"},"Car"),'". Therefore, our node named Rental Company will be in charge of carrying out this action. To do so, we execute the following command:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},'curl --request POST \'http://localhost:3000/api/event-requests\' \\\n    --header \'Content-Type: application/json\' \\\n    --data \'{\n        "request": {\n            "Create": {\n                "governance_id": {{GOVERNANCE-ID}},\n                "schema_id": "car",\n                "namespace": "",\n                "name": "Car-1"\n            }\n        }\n    }\'\n')),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{GOVERNANCE-ID}}")," with the previously saved governance hash identifier.")),(0,o.kt)("p",null,'Once the above command is executed, the "',(0,o.kt)("strong",{parentName:"p"},"request-id"),'" of the event will be returned. It is necessary to save it for future steps.'),(0,o.kt)("p",null,"Then, we execute the following command to check the status of the request:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},"curl 'http://localhost:3000/api/event-requests/{{REQUEST-ID}}/state'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{REQUEST-ID}}")," with the value copied above.")),(0,o.kt)("p",null,"This last command, will provide a response like the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'{\n  "id": {{REQUEST-ID}},\n  "subject_id": {{SUBJECT-ID}},\n  "sn": 0,\n  "state": "finished",\n  "success": true\n}\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note:"),' Save the "',(0,o.kt)("strong",{parentName:"p"},"subject_id"),'" corresponding to the subject, as it will be needed in the next steps of the tutorial.'),(0,o.kt)("p",null,"Next, we run the following command to verify that it has been created correctly:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},"curl 'http://localhost:3000/api/subjects/{{SUBJECT-ID}}'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{SUBJECT-ID}}")," with the value copied from above.")),(0,o.kt)("h3",{id:"subject-transfer"},"Subject transfer"),(0,o.kt)("p",null,"Once the subject is created, we are ready to transfer the ownership of this subject to the car. It should be noted that any subject that has not completed its life cycle in ",(0,o.kt)("strong",{parentName:"p"},"TAPLE")," can be transferred to a new owner, whether or not it is part of the governance where the subject has been declared."),(0,o.kt)("p",null,'Next, since the vehicle is not a member of the governance, the vehicle node will not receive it directly, so it needs to actively request it. For this, it is necessary to know the "',(0,o.kt)("strong",{parentName:"p"},"id"),'" of the governance and at least the identifier of a member of the governance to be able to request it. Having this clear, we should execute the following command:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Vehicle"',title:'"Node:','Vehicle"':!0},"curl --request PUT 'http://localhost:3003/api/allowed-subjects/{{GOVERNANCE-ID}}' \\\n    --header 'Content-Type: application/json' \\\n    --data-raw '{\n        \"providers\": [\"EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs\"]\n    }'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must substitute ",(0,o.kt)("strong",{parentName:"p"},"{{GOVERNANCE-ID}}")," for the previously saved governance hash identifier.")),(0,o.kt)("p",null,"Now, we activate the pre-authorization of the subject that we want to transfer to this new node. To do this, we execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Vehicle"',title:'"Node:','Vehicle"':!0},"curl --request PUT 'http://localhost:3003/api/allowed-subjects/{{SUBJECT-ID}}' \\\n    --header 'Content-Type: application/json' \\\n    --data-raw '{\n        \"providers\": []\n    }'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{SUBJECT-ID}}")," with the hash identifier of the previously saved subject.")),(0,o.kt)("p",null,"It should be noted that in this case it is not necessary to set a provider, since when we obtain the property of the same, it will send it to us automatically."),(0,o.kt)("p",null,'So far, when creating the subject, we have not had to declare its public key, although we have always had the possibility to do so. In TAPLE, transfers always occur upon a request from the future owner. For this, he must know the "',(0,o.kt)("strong",{parentName:"p"},"subject_id"),'" of the subject to be able to authorize it, i.e. when messages arrive, accept it, and in addition, he needs to create a key pair. In its transfer request, it sends to the current owner the public key to be used after the transfer. To generate a public key, we must execute the following:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Vehicle"',title:'"Node:','Vehicle"':!0},"curl --request POST 'http://localhost:3003/api/keys' \\\n    --form 'algorithm=\"Ed25519\"'\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note:"),' Save the "',(0,o.kt)("strong",{parentName:"p"},"public_key"),'" field, as it will be needed for later steps in the tutorial.'),(0,o.kt)("p",null,"Next, we need to sign the transfer request with the cryptographic material of the new node. To do this, we will use our ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/taple-docsite/docs/0.2/learn/client-tools#taple-sign"},"TAPLE-Sign"))," tool and execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Another terminal"',title:'"Another','terminal"':!0},'taple-sign "2a71a0aff12c2de9e21d76e0538741aa9ac6da9ff7f467cf8b7211bd008a3198" \'{"Transfer":{"subject_id":"{{SUBJECT-ID}}","public_key":"{{PUBLIC-KEY}}"}}\'\n')),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{SUBJECT-ID}}")," with the previously created subject identifier hash and ",(0,o.kt)("strong",{parentName:"p"},"{{PUBLIC_KEY}}")," with the previously saved key.")),(0,o.kt)("p",null,"We will then include the result of the previous execution in the next request:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},"curl 'http://localhost:3000/api/event-requests' \\\n    --header 'Content-Type: application/json' \\\n    --data-raw '{{SIGN-RESULT}}'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must replace ",(0,o.kt)("strong",{parentName:"p"},"{{SIGN-RESULT}}")," with the result of the previous request.")),(0,o.kt)("p",null,"Leaving us with something similar to the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Rental Company"',title:'"Node:',Rental:!0,'Company"':!0},'curl \'http://localhost:3000/api/event-requests\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n    "request": {\n        "Transfer": {\n        "subject_id": "{{SUBJECT-ID}}",\n        "public_key": "{{PUBLIC-KEY}}"\n        }\n    },\n    "signature": {\n        "signer": "EtbFWPL6eVOkvMMiAYV8qio291zd3viCMepUL6sY7RjA",\n        "timestamp": 1690370240429930638,\n        "value": "SEU8NJSZMH4r2MWL71oJHIDkjlr9ia1flwkxlQrkC1sMdarJrtMYmiAJqPIahbYPeAge50PRXyHKmLz84TZhhVDQ"\n    }\n}\'\n')),(0,o.kt)("p",null,"Finally, the new node should be able to visualize this new subject and verify that it is the new owner of the subject. To do this, we execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Vehicle"',title:'"Node:','Vehicle"':!0},"curl 'http://localhost:3003/api/subjects/{{SUBJECT-ID}}'\n")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Note that in the request, you must substitute ",(0,o.kt)("strong",{parentName:"p"},"{{SUBJECT-ID}}")," for the hash identifier of the previously saved subject.")))}p.isMDXComponent=!0}}]);