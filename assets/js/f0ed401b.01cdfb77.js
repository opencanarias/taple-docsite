"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[5819],{3905:(g,I,C)=>{C.d(I,{Zo:()=>c,kt:()=>d});var e=C(67294);function A(g,I,C){return I in g?Object.defineProperty(g,I,{value:C,enumerable:!0,configurable:!0,writable:!0}):g[I]=C,g}function n(g,I){var C=Object.keys(g);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(g);I&&(e=e.filter((function(I){return Object.getOwnPropertyDescriptor(g,I).enumerable}))),C.push.apply(C,e)}return C}function t(g){for(var I=1;I<arguments.length;I++){var C=null!=arguments[I]?arguments[I]:{};I%2?n(Object(C),!0).forEach((function(I){A(g,I,C[I])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(C)):n(Object(C)).forEach((function(I){Object.defineProperty(g,I,Object.getOwnPropertyDescriptor(C,I))}))}return g}function a(g,I){if(null==g)return{};var C,e,A=function(g,I){if(null==g)return{};var C,e,A={},n=Object.keys(g);for(e=0;e<n.length;e++)C=n[e],I.indexOf(C)>=0||(A[C]=g[C]);return A}(g,I);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(g);for(e=0;e<n.length;e++)C=n[e],I.indexOf(C)>=0||Object.prototype.propertyIsEnumerable.call(g,C)&&(A[C]=g[C])}return A}var l=e.createContext({}),i=function(g){var I=e.useContext(l),C=I;return g&&(C="function"==typeof g?g(I):t(t({},I),g)),C},c=function(g){var I=i(g.components);return e.createElement(l.Provider,{value:I},g.children)},o={inlineCode:"code",wrapper:function(g){var I=g.children;return e.createElement(e.Fragment,{},I)}},r=e.forwardRef((function(g,I){var C=g.components,A=g.mdxType,n=g.originalType,l=g.parentName,c=a(g,["components","mdxType","originalType","parentName"]),r=i(C),d=A,s=r["".concat(l,".").concat(d)]||r[d]||o[d]||n;return C?e.createElement(s,t(t({ref:I},c),{},{components:C})):e.createElement(s,t({ref:I},c))}));function d(g,I){var C=arguments,A=I&&I.mdxType;if("string"==typeof g||A){var n=C.length,t=new Array(n);t[0]=r;var a={};for(var l in I)hasOwnProperty.call(I,l)&&(a[l]=I[l]);a.originalType=g,a.mdxType="string"==typeof g?g:A,t[1]=a;for(var i=2;i<n;i++)t[i]=C[i];return e.createElement.apply(null,t)}return e.createElement.apply(null,C)}r.displayName="MDXCreateElement"},34466:(g,I,C)=>{C.r(I),C.d(I,{assets:()=>l,contentTitle:()=>t,default:()=>o,frontMatter:()=>n,metadata:()=>a,toc:()=>i});var e=C(87462),A=(C(67294),C(3905));const n={},t="Adding a schema",a={unversionedId:"build/assets-traceability/adding-schema",id:"version-0.2/build/assets-traceability/adding-schema",title:"Adding a schema",description:"We have added our first member to the governance, but there's still more to complete, as we haven't defined the data structure for tracking Wine type subjects in this use case.",source:"@site/versioned_docs/version-0.2/build/assets-traceability/adding-schema.md",sourceDirName:"build/assets-traceability",slug:"/build/assets-traceability/adding-schema",permalink:"/taple-docsite/docs/0.2/build/assets-traceability/adding-schema",draft:!1,tags:[],version:"0.2",lastUpdatedAt:1698048796,formattedLastUpdatedAt:"Oct 23, 2023",frontMatter:{},sidebar:"buildSidebar",previous:{title:"Creating an event",permalink:"/taple-docsite/docs/0.2/build/assets-traceability/creating-event"},next:{title:"Adding participants",permalink:"/taple-docsite/docs/0.2/build/assets-traceability/adding-participants"}},l={},i=[{value:"Schema",id:"schema",level:2},{value:"Smart Contract",id:"smart-contract",level:2},{value:"Back to Taple network",id:"back-to-taple-network",level:2}],c={toc:i};function o(g){let{components:I,...C}=g;return(0,A.kt)("wrapper",(0,e.Z)({},c,C,{components:I,mdxType:"MDXLayout"}),(0,A.kt)("h1",{id:"adding-a-schema"},"Adding a schema"),(0,A.kt)("p",null,"We have added our first member to the governance, but there's still more to complete, as we haven't defined the data structure for tracking ",(0,A.kt)("em",{parentName:"p"},"Wine")," type subjects in this use case."),(0,A.kt)("p",null,"To progress in the tutorial, we need to define a data structure where we can store information for each wine bottle. In Taple, this definition is done using ",(0,A.kt)("a",{parentName:"p",href:"/taple-docsite/docs/0.2/discover/schemas"},(0,A.kt)("em",{parentName:"a"},"schemas")),", which allow us to specify the fields, data types, and relationships we want to store, such as harvest number, type of grape, origin of the grape, organic certification, etc."),(0,A.kt)("h2",{id:"schema"},"Schema"),(0,A.kt)("p",null,"Before proceeding, it's essential to have a clear idea of the information we want to store for each wine bottle. Then, we'll proceed to create the schema that represents that information appropriately. Below is the schema we have created:"),(0,A.kt)("ul",null,(0,A.kt)("li",{parentName:"ul"},"Harvest number"),(0,A.kt)("li",{parentName:"ul"},"Type of grape"),(0,A.kt)("li",{parentName:"ul"},"Origin of the grape"),(0,A.kt)("li",{parentName:"ul"},"Certificate authenticating whether it is organic or not"),(0,A.kt)("li",{parentName:"ul"},"Values to be changed in the temperature control event:",(0,A.kt)("ul",{parentName:"li"},(0,A.kt)("li",{parentName:"ul"},"Timestamp of the last check"),(0,A.kt)("li",{parentName:"ul"},"Value that confirms whether the wine cold chain has been complied with")))),(0,A.kt)("p",null,"The schema must be defined in ",(0,A.kt)("a",{parentName:"p",href:"/taple-docsite/docs/0.2/learn/json-schema"},(0,A.kt)("em",{parentName:"a"},"json-schema"))," format so that Taple can interpret it correctly. Here's the schema in this format:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "id": "Wine",\n    "description": "Representation of a bottle of wine",\n    "type": "object",\n    "properties": {\n        "harvest": {\n            "description": "Harvest number",\n            "type": "integer"\n        },\n        "grape": {\n            "description": "Type of grape",\n            "type": ["string", "null"],\n            "enum": ["CabernetSauvignon", "Chardonnay", "PinotNoir", null]\n        },\n        "origin": {\n            "description": "Origin of the grape",\n            "type": "string"\n        },\n        "organic_certified": {\n            "description": "Certificate authenticating whether it is organic or not",\n            "type": ["boolean", "null"]\n        },\n        "temperature_control": {\n            "description": "Values to be changed in the temperature control event",\n            "type": "object",\n            "properties": {\n                "last_check": {\n                    "description": "Timestamp of last check",\n                    "type": "number"\n                },\n                "temperature_ok": {\n                    "description": "Value that corroborates whether the wine cold chain has been complied with",\n                    "type": "boolean"\n                }\n            },\n            "required": [ "last_check", "temperature_ok" ],\n            "additionalProperties": false\n        }\n    },\n    "required": [ "harvest", "grape", "origin", "organic_certified", "temperature_control" ],\n    "additionalProperties": false\n}\n')),(0,A.kt)("h2",{id:"smart-contract"},"Smart Contract"),(0,A.kt)("p",null,"After declaring our schema, the next step is to create the ",(0,A.kt)("a",{parentName:"p",href:"/taple-docsite/docs/0.2/learn/smart-contracts"},(0,A.kt)("em",{parentName:"a"},"smart contract"))," as we need a way to update the states of the subjects we declare. Therefore, we'll create a small project for the contract development, taking reference from what has been ",(0,A.kt)("a",{parentName:"p",href:"/taple-docsite/docs/0.2/learn/smart-contracts-programming"},"declared in this section"),"."),(0,A.kt)("ol",null,(0,A.kt)("li",{parentName:"ol"},(0,A.kt)("p",{parentName:"li"},"Execute the following command:"),(0,A.kt)("pre",{parentName:"li"},(0,A.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Another terminal"',title:'"Another','terminal"':!0},"cargo new wine-contract\n")),(0,A.kt)("p",{parentName:"li"},"This will create an empty Rust project with the specified name, resulting in the following structure:"),(0,A.kt)("pre",{parentName:"li"},(0,A.kt)("code",{parentName:"pre",className:"language-bash"},".\n\u251c\u2500\u2500 Cargo.toml\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 main.rs\n"))),(0,A.kt)("li",{parentName:"ol"},(0,A.kt)("p",{parentName:"li"},"We need to modify the ",(0,A.kt)("em",{parentName:"p"},"Cargo.toml")," file to include the Taple contracts ",(0,A.kt)("em",{parentName:"p"},"SDK")," as well as the ",(0,A.kt)("em",{parentName:"p"},"serde")," module, which will handle data serialization and deserialization:"),(0,A.kt)("pre",{parentName:"li"},(0,A.kt)("code",{parentName:"pre",className:"language-toml"},'[package]\nname = "wine-contract"\nversion = "0.1.0"\nedition = "2021"\n\n[dependencies]\nserde = { version = "1.0.152", features = ["derive"] }\ntaple-sc-rust = { git = "https://github.com/opencanarias/taple-sc-rust.git", branch = "main"}\n')),(0,A.kt)("admonition",{parentName:"li",type:"info"},(0,A.kt)("p",{parentName:"admonition"},"From now on, all the remaining numbered steps will be performed within the ",(0,A.kt)("inlineCode",{parentName:"p"},"main.rs")," file."))),(0,A.kt)("li",{parentName:"ol"},(0,A.kt)("p",{parentName:"li"},"Add the necessary dependencies at the beginning of our file:"),(0,A.kt)("pre",{parentName:"li"},(0,A.kt)("code",{parentName:"pre",className:"language-rust"},"use taple_sc_rust as sdk;\nuse serde::{Deserialize, Serialize};\n"))),(0,A.kt)("li",{parentName:"ol"},(0,A.kt)("p",{parentName:"li"},"Next, we'll add the data structures that will represent our ",(0,A.kt)("em",{parentName:"p"},"Wine")," subjects:"),(0,A.kt)("pre",{parentName:"li"},(0,A.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Serialize, Deserialize, Clone, PartialEq)] \nenum Grape {\n    CabernetSauvignon,\n    Chardonnay,\n    PinotNoir,\n}\n\n#[derive(Serialize, Deserialize, Clone)]\nstruct TemperatureControl {\n    pub last_check: u32,\n    pub temperature_ok: bool,\n}\n\n#[derive(Serialize, Deserialize, Clone)]\nstruct State {\n    pub harvest: u32,\n    pub grape: Option<Grape>,\n    pub origin: String,\n    pub organic_certified: Option<bool>,\n    pub temperature_control: TemperatureControl,\n}\n"))),(0,A.kt)("li",{parentName:"ol"},(0,A.kt)("p",{parentName:"li"},"Now is the time to define the state events that can be triggered on our ",(0,A.kt)("em",{parentName:"p"},"Wine")," type subjects, which are:"),(0,A.kt)("ul",{parentName:"li"},(0,A.kt)("li",{parentName:"ul"},(0,A.kt)("em",{parentName:"li"},"Init"),": Responsible for initializing only those subjects coming from a ",(0,A.kt)("strong",{parentName:"li"},"genesis")," state."),(0,A.kt)("li",{parentName:"ul"},(0,A.kt)("em",{parentName:"li"},"TemperatureControl"),": In charge of performing the temperature check."),(0,A.kt)("li",{parentName:"ul"},(0,A.kt)("em",{parentName:"li"},"OrganicCertification"),": Responsible for modifying the state of organic certification.")),(0,A.kt)("p",{parentName:"li"},"The added code will be:"),(0,A.kt)("pre",{parentName:"li"},(0,A.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Serialize, Deserialize)]\nenum StateEvent {\n    Init {\n        harvest: u32,\n        grape: String,\n        origin: String,\n    },\n    TemperatureControl {\n        temperature: f32,\n        timestamp: u32,\n    },\n    OrganicCertification {\n        fertilizers_control: bool,\n        pesticides_control: bool,\n        analytics: bool,\n        additional_info: String,\n    },\n}\n"))),(0,A.kt)("li",{parentName:"ol"},(0,A.kt)("p",{parentName:"li"},"Add the entry function for the contract, equivalent to the ",(0,A.kt)("inlineCode",{parentName:"p"},"main")," function:"),(0,A.kt)("pre",{parentName:"li"},(0,A.kt)("code",{parentName:"pre",className:"language-rust"},"#[no_mangle]\npub unsafe fn main_function(state_ptr: i32, event_ptr: i32, is_owner: i32) -> u32 {\n    sdk::execute_contract(state_ptr, event_ptr, is_owner, contract_logic)\n}\n")),(0,A.kt)("admonition",{parentName:"li",title:"WARNING",type:"warning"},(0,A.kt)("p",{parentName:"admonition"},"It's important for this function to always have the same name specified here since it's the identifier with which the evaluator will try to execute it, and it will result in an error if not found."))),(0,A.kt)("li",{parentName:"ol"},(0,A.kt)("p",{parentName:"li"},"Lastly, add the business logic that will act in each of the cases for the state events declared above:"),(0,A.kt)("pre",{parentName:"li"},(0,A.kt)("code",{parentName:"pre",className:"language-rust"},'const TEMPERATURE_RANGE: (f32, f32) = (10.0, 16.0);\n\nfn contract_logic(\n    context: &sdk::Context<State, StateEvent>,\n    contract_result: &mut sdk::ContractResult<State>,\n) {\n    let state = &mut contract_result.final_state;\n    match &context.event {\n        StateEvent::Init {\n            harvest,\n            grape,\n            origin,\n        } => {\n            if context.is_owner && !check_subject_has_been_initiated(state) {\n                let grape = match grape.as_str() {\n                    "CabernetSauvignon" => Some(Grape::CabernetSauvignon),\n                    "Chardonnay" => Some(Grape::Chardonnay),\n                    "PinotNoir" => Some(Grape::PinotNoir),\n                    _ => None,\n                };\n                if grape.is_some() {\n                    state.harvest = *harvest;\n                    state.grape = grape;\n                    state.origin = origin.to_string();\n                    contract_result.success = true;\n                }\n            }\n        }\n        StateEvent::TemperatureControl {\n            temperature,\n            timestamp,\n        } => {\n            if context.is_owner && check_subject_has_been_initiated(state) {\n                if check_temperature_in_range(*temperature)\n                    && state.temperature_control.temperature_ok\n                {\n                    state.temperature_control.last_check = *timestamp;\n                } else {\n                    state.temperature_control.temperature_ok = false;\n                    state.temperature_control.last_check = *timestamp;\n                }\n                contract_result.success = true;\n            }\n        }\n        StateEvent::OrganicCertification {\n            fertilizers_control,\n            pesticides_control,\n            analytics,\n            additional_info,\n        } => {\n            if check_subject_has_been_initiated(state) {\n                match state.organic_certified {\n                    Some(organic_cerified) => {\n                        if organic_cerified\n                            && !check_is_organic(\n                                *fertilizers_control,\n                                *pesticides_control,\n                                *analytics,\n                            )\n                        {\n                            state.organic_certified = Some(false);\n                        }\n                    }\n                    None => {\n                        if check_is_organic(*fertilizers_control, *pesticides_control, *analytics) {\n                            state.organic_certified = Some(true);\n                        } else {\n                            state.organic_certified = Some(false);\n                        }\n                    }\n                }\n                contract_result.success = true;\n            }\n        }\n    }\n}\n\nfn check_subject_has_been_initiated(state: &State) -> bool {\n    let initial_grape = match state.grape {\n        Some(_) => false,\n        None => true,\n    };\n    if state.harvest == 0 && initial_grape && state.origin == format!("") {\n        return false;\n    }\n    return true;\n}\n\nfn check_temperature_in_range(temperature: f32) -> bool {\n    if temperature >= TEMPERATURE_RANGE.0 && temperature <= TEMPERATURE_RANGE.1 {\n        return true;\n    }\n    return false;\n}\n\nfn check_is_organic(fertilizers_control: bool, pesticides_control: bool, analytics: bool) -> bool {\n    if fertilizers_control && pesticides_control && analytics {\n        return true;\n    }\n    return false;\n}\n')),(0,A.kt)("admonition",{parentName:"li",type:"caution"},(0,A.kt)("p",{parentName:"admonition"},"It's essential to include ",(0,A.kt)("inlineCode",{parentName:"p"},"contract_result.success = true")," in those points of the ",(0,A.kt)("inlineCode",{parentName:"p"},"contract_logic")," function where we believe the execution has been successful. Otherwise, when emitting the events, they will always end with ",(0,A.kt)("inlineCode",{parentName:"p"},'"success" = false')," state.")))),(0,A.kt)("p",null,"Taple only supports contracts in ",(0,A.kt)("em",{parentName:"p"},"Base64"),", so we'll need to transform ours into that format. For this purpose, Linux has its own utility called ",(0,A.kt)("inlineCode",{parentName:"p"},"base64"),". Therefore, what we need to do in our ",(0,A.kt)("inlineCode",{parentName:"p"},"main.rs")," file is:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Another terminal"',title:'"Another','terminal"':!0},"base64 main.rs\n")),(0,A.kt)("p",null,"The returned result will be the contract encoded in ",(0,A.kt)("em",{parentName:"p"},"base64"),"."),(0,A.kt)("h2",{id:"back-to-taple-network"},"Back to Taple network"),(0,A.kt)("p",null,"Once we have declared both, the schema and the smart contract, it's necessary to emit a ",(0,A.kt)("strong",{parentName:"p"},"fact")," event to the governance to add this new information."),(0,A.kt)("p",null,"Let's start by verifying the changes we want to make in the governance properties. At this point, our governance should look like the following:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "policies": [\n        {\n            "approve": {\n                "quorum": "MAJORITY"\n            },\n            "evaluate": {\n                "quorum": "MAJORITY"\n            },\n            "id": "governance",\n            "validate": {\n                "quorum": "MAJORITY"\n            }\n        }\n    ],\n    "schemas": []\n}\n')),(0,A.kt)("p",null,"Now, we need to include the ",(0,A.kt)("em",{parentName:"p"},"schema"),", the ",(0,A.kt)("em",{parentName:"p"},"smart contract"),", the ",(0,A.kt)("a",{parentName:"p",href:"/taple-docsite/docs/0.2/discover/events#create-event"},(0,A.kt)("strong",{parentName:"a"},"genesis"))," state of a subject, as well as the policies that will be applied to them:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "policies": [\n\n        ...\n\n        {\n            "approve": {\n                "quorum": "MAJORITY"\n            },\n            "evaluate": {\n                "quorum": "MAJORITY"\n            },\n            "id": "Wine",\n            "validate": {\n                "quorum": "MAJORITY"\n            }\n        }\n    ],\n    "schemas": [\n        {\n            "contract": {\n                "raw": "dXNlIHRhcGxlX3NjX3J1c3QgYXMgc2RrOwp1c2Ugc2VyZGU6OntEZXNlcmlhbGl6ZSwgU2VyaWFs\n                        aXplfTsKCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lLCBQYXJ0aWFsRXEp\n                        XSAKZW51bSBHcmFwZSB7CiAgICBDYWJlcm5ldFNhdXZpZ25vbiwKICAgIENoYXJkb25uYXksCiAg\n                        ICBQaW5vdE5vaXIsCn0KCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lKV0K\n                        c3RydWN0IFRlbXBlcmF0dXJlQ29udHJvbCB7CiAgICBwdWIgbGFzdF9jaGVjazogdTMyLAogICAg\n                        cHViIHRlbXBlcmF0dXJlX29rOiBib29sLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFs\n                        aXplLCBDbG9uZSldCnN0cnVjdCBTdGF0ZSB7CiAgICBwdWIgaGFydmVzdDogdTMyLAogICAgcHVi\n                        IGdyYXBlOiBPcHRpb248R3JhcGU+LAogICAgcHViIG9yaWdpbjogU3RyaW5nLAogICAgcHViIG9y\n                        Z2FuaWNfY2VydGlmaWVkOiBPcHRpb248Ym9vbD4sCiAgICBwdWIgdGVtcGVyYXR1cmVfY29udHJv\n                        bDogVGVtcGVyYXR1cmVDb250cm9sLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXpl\n                        KV0KZW51bSBTdGF0ZUV2ZW50IHsKICAgIEluaXQgewogICAgICAgIGhhcnZlc3Q6IHUzMiwKICAg\n                        ICAgICBncmFwZTogU3RyaW5nLAogICAgICAgIG9yaWdpbjogU3RyaW5nLAogICAgfSwKICAgIFRl\n                        bXBlcmF0dXJlQ29udHJvbCB7CiAgICAgICAgdGVtcGVyYXR1cmU6IGYzMiwKICAgICAgICB0aW1l\n                        c3RhbXA6IHUzMiwKICAgIH0sCiAgICBPcmdhbmljQ2VydGlmaWNhdGlvbiB7CiAgICAgICAgZmVy\n                        dGlsaXplcnNfY29udHJvbDogYm9vbCwKICAgICAgICBwZXN0aWNpZGVzX2NvbnRyb2w6IGJvb2ws\n                        CiAgICAgICAgYW5hbHl0aWNzOiBib29sLAogICAgICAgIGFkZGl0aW9uYWxfaW5mbzogU3RyaW5n\n                        LAogICAgfSwKfQoKI1tub19tYW5nbGVdCnB1YiB1bnNhZmUgZm4gbWFpbl9mdW5jdGlvbihzdGF0\n                        ZV9wdHI6IGkzMiwgZXZlbnRfcHRyOiBpMzIsIGlzX293bmVyOiBpMzIpIC0+IHUzMiB7CiAgICBz\n                        ZGs6OmV4ZWN1dGVfY29udHJhY3Qoc3RhdGVfcHRyLCBldmVudF9wdHIsIGlzX293bmVyLCBjb250\n                        cmFjdF9sb2dpYykKfQoKY29uc3QgVEVNUEVSQVRVUkVfUkFOR0U6IChmMzIsIGYzMikgPSAoMTAu\n                        MCwgMTYuMCk7CgpmbiBjb250cmFjdF9sb2dpYygKICAgIGNvbnRleHQ6ICZzZGs6OkNvbnRleHQ8\n                        U3RhdGUsIFN0YXRlRXZlbnQ+LAogICAgY29udHJhY3RfcmVzdWx0OiAmbXV0IHNkazo6Q29udHJh\n                        Y3RSZXN1bHQ8U3RhdGU+LAopIHsKICAgIGxldCBzdGF0ZSA9ICZtdXQgY29udHJhY3RfcmVzdWx0\n                        LmZpbmFsX3N0YXRlOwogICAgbWF0Y2ggJmNvbnRleHQuZXZlbnQgewogICAgICAgIFN0YXRlRXZl\n                        bnQ6OkluaXQgewogICAgICAgICAgICBoYXJ2ZXN0LAogICAgICAgICAgICBncmFwZSwKICAgICAg\n                        ICAgICAgb3JpZ2luLAogICAgICAgIH0gPT4gewogICAgICAgICAgICBpZiBjb250ZXh0LmlzX293\n                        bmVyICYmICFjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZSkgewogICAgICAg\n                        ICAgICAgICAgbGV0IGdyYXBlID0gbWF0Y2ggZ3JhcGUuYXNfc3RyKCkgewogICAgICAgICAgICAg\n                        ICAgICAgICJDYWJlcm5ldFNhdXZpZ25vbiIgPT4gU29tZShHcmFwZTo6Q2FiZXJuZXRTYXV2aWdu\n                        b24pLAogICAgICAgICAgICAgICAgICAgICJDaGFyZG9ubmF5IiA9PiBTb21lKEdyYXBlOjpDaGFy\n                        ZG9ubmF5KSwKICAgICAgICAgICAgICAgICAgICAiUGlub3ROb2lyIiA9PiBTb21lKEdyYXBlOjpQ\n                        aW5vdE5vaXIpLAogICAgICAgICAgICAgICAgICAgIF8gPT4gTm9uZSwKICAgICAgICAgICAgICAg\n                        IH07CiAgICAgICAgICAgICAgICBpZiBncmFwZS5pc19zb21lKCkgewogICAgICAgICAgICAgICAg\n                        ICAgIHN0YXRlLmhhcnZlc3QgPSAqaGFydmVzdDsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS5n\n                        cmFwZSA9IGdyYXBlOwogICAgICAgICAgICAgICAgICAgIHN0YXRlLm9yaWdpbiA9IG9yaWdpbi50\n                        b19zdHJpbmcoKTsKICAgICAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9\n                        IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg\n                        U3RhdGVFdmVudDo6VGVtcGVyYXR1cmVDb250cm9sIHsKICAgICAgICAgICAgdGVtcGVyYXR1cmUs\n                        CiAgICAgICAgICAgIHRpbWVzdGFtcCwKICAgICAgICB9ID0+IHsKICAgICAgICAgICAgaWYgY29u\n                        dGV4dC5pc19vd25lciAmJiBjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZSkg\n                        ewogICAgICAgICAgICAgICAgaWYgY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UoKnRlbXBlcmF0\n                        dXJlKQogICAgICAgICAgICAgICAgICAgICYmIHN0YXRlLnRlbXBlcmF0dXJlX2NvbnRyb2wudGVt\n                        cGVyYXR1cmVfb2sKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS50\n                        ZW1wZXJhdHVyZV9jb250cm9sLmxhc3RfY2hlY2sgPSAqdGltZXN0YW1wOwogICAgICAgICAgICAg\n                        ICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9s\n                        LnRlbXBlcmF0dXJlX29rID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGVtcGVy\n                        YXR1cmVfY29udHJvbC5sYXN0X2NoZWNrID0gKnRpbWVzdGFtcDsKICAgICAgICAgICAgICAgIH0K\n                        ICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICAg\n                        ICAgfQogICAgICAgIH0KICAgICAgICBTdGF0ZUV2ZW50OjpPcmdhbmljQ2VydGlmaWNhdGlvbiB7\n                        CiAgICAgICAgICAgIGZlcnRpbGl6ZXJzX2NvbnRyb2wsCiAgICAgICAgICAgIHBlc3RpY2lkZXNf\n                        Y29udHJvbCwKICAgICAgICAgICAgYW5hbHl0aWNzLAogICAgICAgICAgICBhZGRpdGlvbmFsX2lu\n                        Zm8sCiAgICAgICAgfSA9PiB7CiAgICAgICAgICAgIGlmIGNoZWNrX3N1YmplY3RfaGFzX2JlZW5f\n                        aW5pdGlhdGVkKHN0YXRlKSB7CiAgICAgICAgICAgICAgICBtYXRjaCBzdGF0ZS5vcmdhbmljX2Nl\n                        cnRpZmllZCB7CiAgICAgICAgICAgICAgICAgICAgU29tZShvcmdhbmljX2NlcmlmaWVkKSA9PiB7\n                        CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9yZ2FuaWNfY2VyaWZpZWQKICAgICAgICAgICAg\n                        ICAgICAgICAgICAgICAgICYmICFjaGVja19pc19vcmdhbmljKAogICAgICAgICAgICAgICAgICAg\n                        ICAgICAgICAgICAgICpmZXJ0aWxpemVyc19jb250cm9sLAogICAgICAgICAgICAgICAgICAgICAg\n                        ICAgICAgICAgICpwZXN0aWNpZGVzX2NvbnRyb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\n                        ICAgICAgKmFuYWx5dGljcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAg\n                        ICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5p\n                        Y19jZXJ0aWZpZWQgPSBTb21lKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\n                        ICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBOb25lID0+IHsKICAgICAgICAg\n                        ICAgICAgICAgICAgICAgaWYgY2hlY2tfaXNfb3JnYW5pYygqZmVydGlsaXplcnNfY29udHJvbCwg\n                        KnBlc3RpY2lkZXNfY29udHJvbCwgKmFuYWx5dGljcykgewogICAgICAgICAgICAgICAgICAgICAg\n                        ICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKHRydWUpOwogICAgICAgICAgICAg\n                        ICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3Jn\n                        YW5pY19jZXJ0aWZpZWQgPSBTb21lKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQog\n                        ICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNv\n                        bnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\n                        IH0KfQoKZm4gY2hlY2tfc3ViamVjdF9oYXNfYmVlbl9pbml0aWF0ZWQoc3RhdGU6ICZTdGF0ZSkg\n                        LT4gYm9vbCB7CiAgICBsZXQgaW5pdGlhbF9ncmFwZSA9IG1hdGNoIHN0YXRlLmdyYXBlIHsKICAg\n                        ICAgICBTb21lKF8pID0+IGZhbHNlLAogICAgICAgIE5vbmUgPT4gdHJ1ZSwKICAgIH07CiAgICBp\n                        ZiBzdGF0ZS5oYXJ2ZXN0ID09IDAgJiYgaW5pdGlhbF9ncmFwZSAmJiBzdGF0ZS5vcmlnaW4gPT0g\n                        Zm9ybWF0ISgiIikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0cnVl\n                        Owp9CgpmbiBjaGVja190ZW1wZXJhdHVyZV9pbl9yYW5nZSh0ZW1wZXJhdHVyZTogZjMyKSAtPiBi\n                        b29sIHsKICAgIGlmIHRlbXBlcmF0dXJlID49IFRFTVBFUkFUVVJFX1JBTkdFLjAgJiYgdGVtcGVy\n                        YXR1cmUgPD0gVEVNUEVSQVRVUkVfUkFOR0UuMSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\n                        CiAgICByZXR1cm4gZmFsc2U7Cn0KCmZuIGNoZWNrX2lzX29yZ2FuaWMoZmVydGlsaXplcnNfY29u\n                        dHJvbDogYm9vbCwgcGVzdGljaWRlc19jb250cm9sOiBib29sLCBhbmFseXRpY3M6IGJvb2wpIC0+\n                        IGJvb2wgewogICAgaWYgZmVydGlsaXplcnNfY29udHJvbCAmJiBwZXN0aWNpZGVzX2NvbnRyb2wg\n                        JiYgYW5hbHl0aWNzIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBmYWxz\n                        ZTsKfQo=\n                        "\n            },\n            "id": "Wine",\n            "initial_value": {\n                "grape": null,\n                "harvest": 0,\n                "organic_certified": null,\n                "origin": "",\n                "temperature_control": {\n                    "last_check": 0,\n                    "temperature_ok": true\n                }\n            },\n            "schema": {\n                "additionalProperties": false,\n                "description": "Representation of a bottle of wine",\n                "properties": {\n                    "grape": {\n                        "description": "Type of grape",\n                        "enum": [\n                            "CabernetSauvignon",\n                            "Chardonnay",\n                            "PinotNoir",\n                            null\n                        ],\n                        "type": [\n                            "string",\n                            "null"\n                        ]\n                    },\n                    "harvest": {\n                        "description": "Harvest number",\n                        "type": "integer"\n                    },\n                    "organic_certified": {\n                        "description": "Certificate authenticating whether it is organic or not",\n                        "type": [\n                            "boolean",\n                            "null"\n                        ]\n                    },\n                    "origin": {\n                        "description": "Origin of the grape",\n                        "type": "string"\n                    },\n                    "temperature_control": {\n                        "additionalProperties": false,\n                        "description": "Values to be changed in the temperature control event",\n                        "properties": {\n                            "last_check": {\n                                "description": "Timestamp of last check",\n                                "type": "integer"\n                            },\n                            "temperature_ok": {\n                                "description": "Value that corroborates whether the wine cold chain has been complied with",\n                                "type": "boolean"\n                            }\n                        },\n                        "required": [\n                            "last_check",\n                            "temperature_ok"\n                        ],\n                        "type": "object"\n                    }\n                },\n                "required": [\n                    "harvest",\n                    "grape",\n                    "origin",\n                    "organic_certified",\n                    "temperature_control"\n                ],\n                "type": "object"\n            }\n        }\n    ]\n}\n')),(0,A.kt)("p",null,"To generate the mentioned changes, we will use our ",(0,A.kt)("a",{parentName:"p",href:"/taple-docsite/docs/0.2/learn/client-tools#taple-patch"},(0,A.kt)("strong",{parentName:"a"},"TAPLE-Patch"))," tool as follows:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Another terminal"',title:'"Another','terminal"':!0},'taple-patch \'{"policies":[{"approve":{"quorum":"MAJORITY"},"evaluate":{"quorum":"MAJORITY"},"id":"governance","validate":{"quorum":"MAJORITY"}}],"schemas":[]}\' \'{"policies":[{"approve":{"quorum":"MAJORITY"},"evaluate":{"quorum":"MAJORITY"},"id":"governance","validate":{"quorum":"MAJORITY"}},{"approve":{"quorum":"MAJORITY"},"evaluate":{"quorum":"MAJORITY"},"id":"Wine","validate":{"quorum":"MAJORITY"}}],"schemas":[{"contract":{"raw":"dXNlIHRhcGxlX3NjX3J1c3QgYXMgc2RrOwp1c2Ugc2VyZGU6OntEZXNlcmlhbGl6ZSwgU2VyaWFsaXplfTsKCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lLCBQYXJ0aWFsRXEpXSAKZW51bSBHcmFwZSB7CiAgICBDYWJlcm5ldFNhdXZpZ25vbiwKICAgIENoYXJkb25uYXksCiAgICBQaW5vdE5vaXIsCn0KCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lKV0Kc3RydWN0IFRlbXBlcmF0dXJlQ29udHJvbCB7CiAgICBwdWIgbGFzdF9jaGVjazogdTMyLAogICAgcHViIHRlbXBlcmF0dXJlX29rOiBib29sLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplLCBDbG9uZSldCnN0cnVjdCBTdGF0ZSB7CiAgICBwdWIgaGFydmVzdDogdTMyLAogICAgcHViIGdyYXBlOiBPcHRpb248R3JhcGU+LAogICAgcHViIG9yaWdpbjogU3RyaW5nLAogICAgcHViIG9yZ2FuaWNfY2VydGlmaWVkOiBPcHRpb248Ym9vbD4sCiAgICBwdWIgdGVtcGVyYXR1cmVfY29udHJvbDogVGVtcGVyYXR1cmVDb250cm9sLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplKV0KZW51bSBTdGF0ZUV2ZW50IHsKICAgIEluaXQgewogICAgICAgIGhhcnZlc3Q6IHUzMiwKICAgICAgICBncmFwZTogU3RyaW5nLAogICAgICAgIG9yaWdpbjogU3RyaW5nLAogICAgfSwKICAgIFRlbXBlcmF0dXJlQ29udHJvbCB7CiAgICAgICAgdGVtcGVyYXR1cmU6IGYzMiwKICAgICAgICB0aW1lc3RhbXA6IHUzMiwKICAgIH0sCiAgICBPcmdhbmljQ2VydGlmaWNhdGlvbiB7CiAgICAgICAgZmVydGlsaXplcnNfY29udHJvbDogYm9vbCwKICAgICAgICBwZXN0aWNpZGVzX2NvbnRyb2w6IGJvb2wsCiAgICAgICAgYW5hbHl0aWNzOiBib29sLAogICAgICAgIGFkZGl0aW9uYWxfaW5mbzogU3RyaW5nLAogICAgfSwKfQoKY29uc3QgVEVNUEVSQVRVUkVfUkFOR0U6IChmMzIsIGYzMikgPSAoMTAuMCwgMTYuMCk7CgojW25vX21hbmdsZV0KcHViIHVuc2FmZSBmbiBtYWluX2Z1bmN0aW9uKHN0YXRlX3B0cjogaTMyLCBldmVudF9wdHI6IGkzMiwgaXNfb3duZXI6IGkzMikgLT4gdTMyIHsKICAgIHNkazo6ZXhlY3V0ZV9jb250cmFjdChzdGF0ZV9wdHIsIGV2ZW50X3B0ciwgaXNfb3duZXIsIGNvbnRyYWN0X2xvZ2ljKQp9CgpmbiBjb250cmFjdF9sb2dpYygKICAgIGNvbnRleHQ6ICZzZGs6OkNvbnRleHQ8U3RhdGUsIFN0YXRlRXZlbnQ+LAogICAgY29udHJhY3RfcmVzdWx0OiAmbXV0IHNkazo6Q29udHJhY3RSZXN1bHQ8U3RhdGU+LAopIHsKICAgIGxldCBzdGF0ZSA9ICZtdXQgY29udHJhY3RfcmVzdWx0LmZpbmFsX3N0YXRlOwogICAgbWF0Y2ggJmNvbnRleHQuZXZlbnQgewogICAgICAgIFN0YXRlRXZlbnQ6OkluaXQgewogICAgICAgICAgICBoYXJ2ZXN0LAogICAgICAgICAgICBncmFwZSwKICAgICAgICAgICAgb3JpZ2luLAogICAgICAgIH0gPT4gewogICAgICAgICAgICBpZiBjb250ZXh0LmlzX293bmVyICYmICFjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZSkgewogICAgICAgICAgICAgICAgbGV0IGdyYXBlID0gbWF0Y2ggZ3JhcGUuYXNfc3RyKCkgewogICAgICAgICAgICAgICAgICAgICJDYWJlcm5ldFNhdXZpZ25vbiIgPT4gU29tZShHcmFwZTo6Q2FiZXJuZXRTYXV2aWdub24pLAogICAgICAgICAgICAgICAgICAgICJDaGFyZG9ubmF5IiA9PiBTb21lKEdyYXBlOjpDaGFyZG9ubmF5KSwKICAgICAgICAgICAgICAgICAgICAiUGlub3ROb2lyIiA9PiBTb21lKEdyYXBlOjpQaW5vdE5vaXIpLAogICAgICAgICAgICAgICAgICAgIF8gPT4gTm9uZSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBpZiBncmFwZS5pc19zb21lKCkgewogICAgICAgICAgICAgICAgICAgIHN0YXRlLmhhcnZlc3QgPSAqaGFydmVzdDsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ncmFwZSA9IGdyYXBlOwogICAgICAgICAgICAgICAgICAgIHN0YXRlLm9yaWdpbiA9IG9yaWdpbi50b19zdHJpbmcoKTsKICAgICAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgU3RhdGVFdmVudDo6VGVtcGVyYXR1cmVDb250cm9sIHsKICAgICAgICAgICAgdGVtcGVyYXR1cmUsCiAgICAgICAgICAgIHRpbWVzdGFtcCwKICAgICAgICB9ID0+IHsKICAgICAgICAgICAgaWYgY29udGV4dC5pc19vd25lciAmJiBjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZSkgewogICAgICAgICAgICAgICAgaWYgY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UoKnRlbXBlcmF0dXJlKQogICAgICAgICAgICAgICAgICAgICYmIHN0YXRlLnRlbXBlcmF0dXJlX2NvbnRyb2wudGVtcGVyYXR1cmVfb2sKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9sLmxhc3RfY2hlY2sgPSAqdGltZXN0YW1wOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9sLnRlbXBlcmF0dXJlX29rID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGVtcGVyYXR1cmVfY29udHJvbC5sYXN0X2NoZWNrID0gKnRpbWVzdGFtcDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBTdGF0ZUV2ZW50OjpPcmdhbmljQ2VydGlmaWNhdGlvbiB7CiAgICAgICAgICAgIGZlcnRpbGl6ZXJzX2NvbnRyb2wsCiAgICAgICAgICAgIHBlc3RpY2lkZXNfY29udHJvbCwKICAgICAgICAgICAgYW5hbHl0aWNzLAogICAgICAgICAgICBhZGRpdGlvbmFsX2luZm8sCiAgICAgICAgfSA9PiB7CiAgICAgICAgICAgIGlmIGNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlKSB7CiAgICAgICAgICAgICAgICBtYXRjaCBzdGF0ZS5vcmdhbmljX2NlcnRpZmllZCB7CiAgICAgICAgICAgICAgICAgICAgU29tZShvcmdhbmljX2NlcmlmaWVkKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9yZ2FuaWNfY2VyaWZpZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmICFjaGVja19pc19vcmdhbmljKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpmZXJ0aWxpemVyc19jb250cm9sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpwZXN0aWNpZGVzX2NvbnRyb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKmFuYWx5dGljcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBOb25lID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2hlY2tfaXNfb3JnYW5pYygqZmVydGlsaXplcnNfY29udHJvbCwgKnBlc3RpY2lkZXNfY29udHJvbCwgKmFuYWx5dGljcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5hcHByb3ZhbF9yZXF1aXJlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCmZuIGNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlOiAmU3RhdGUpIC0+IGJvb2wgewogICAgbGV0IGluaXRpYWxfZ3JhcGUgPSBtYXRjaCBzdGF0ZS5ncmFwZSB7CiAgICAgICAgU29tZShfKSA9PiBmYWxzZSwKICAgICAgICBOb25lID0+IHRydWUsCiAgICB9OwogICAgaWYgc3RhdGUuaGFydmVzdCA9PSAwICYmIGluaXRpYWxfZ3JhcGUgJiYgc3RhdGUub3JpZ2luID09IGZvcm1hdCEoIiIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKfQoKZm4gY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UodGVtcGVyYXR1cmU6IGYzMikgLT4gYm9vbCB7CiAgICBpZiB0ZW1wZXJhdHVyZSA+PSBURU1QRVJBVFVSRV9SQU5HRS4wICYmIHRlbXBlcmF0dXJlIDw9IFRFTVBFUkFUVVJFX1JBTkdFLjEgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgcmV0dXJuIGZhbHNlOwp9CgpmbiBjaGVja19pc19vcmdhbmljKGZlcnRpbGl6ZXJzX2NvbnRyb2w6IGJvb2wsIHBlc3RpY2lkZXNfY29udHJvbDogYm9vbCwgYW5hbHl0aWNzOiBib29sKSAtPiBib29sIHsKICAgIGlmIGZlcnRpbGl6ZXJzX2NvbnRyb2wgJiYgcGVzdGljaWRlc19jb250cm9sICYmIGFuYWx5dGljcyB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0="},"id":"Wine","initial_value":{"grape":null,"harvest":0,"organic_certified":null,"origin":"","temperature_control":{"last_check":0,"temperature_ok":true}},"schema":{"additionalProperties":false,"description":"Representationofabottleofwine","properties":{"grape":{"description":"Typeofgrape","enum":["CabernetSauvignon","Chardonnay","PinotNoir",null],"type":["string","null"]},"harvest":{"description":"Harvestnumber","type":"integer"},"organic_certified":{"description":"Certificateauthenticatingwhetheritisorganicornot","type":["boolean","null"]},"origin":{"description":"Originofthegrape","type":"string"},"temperature_control":{"additionalProperties":false,"description":"Valuestobechangedinthetemperaturecontrolevent","properties":{"last_check":{"description":"Timestampoflastcheck","type":"integer"},"temperature_ok":{"description":"Valuethatcorroborateswhetherthewinecoldchainhasbeencompliedwith","type":"boolean"}},"required":["last_check","temperature_ok"],"type":"object"}},"required":["harvest","grape","origin","organic_certified","temperature_control"],"type":"object"}}]}\'\n')),(0,A.kt)("p",null,"The result obtained will be as follows:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-json"},'[\n    {\n        "op": "add",\n        "path": "/policies/1",\n        "value": {\n            "approve": {\n                "quorum": "MAJORITY"\n            },\n            "evaluate": {\n                "quorum": "MAJORITY"\n            },\n            "id": "Wine",\n            "validate": {\n                "quorum": "MAJORITY"\n            }\n        }\n    },\n    {\n        "op": "add",\n        "path": "/schemas/0",\n        "value": {\n            "contract": {\n                "raw": "dXNlIHRhcGxlX3NjX3J1c3QgYXMgc2RrOwp1c2Ugc2VyZGU6OntEZXNlcmlhbGl6ZSwgU2VyaWFsaXplfTsKCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lLCBQYXJ0aWFsRXEpXSAKZW51bSBHcmFwZSB7CiAgICBDYWJlcm5ldFNhdXZpZ25vbiwKICAgIENoYXJkb25uYXksCiAgICBQaW5vdE5vaXIsCn0KCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lKV0Kc3RydWN0IFRlbXBlcmF0dXJlQ29udHJvbCB7CiAgICBwdWIgbGFzdF9jaGVjazogdTMyLAogICAgcHViIHRlbXBlcmF0dXJlX29rOiBib29sLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplLCBDbG9uZSldCnN0cnVjdCBTdGF0ZSB7CiAgICBwdWIgaGFydmVzdDogdTMyLAogICAgcHViIGdyYXBlOiBPcHRpb248R3JhcGU+LAogICAgcHViIG9yaWdpbjogU3RyaW5nLAogICAgcHViIG9yZ2FuaWNfY2VydGlmaWVkOiBPcHRpb248Ym9vbD4sCiAgICBwdWIgdGVtcGVyYXR1cmVfY29udHJvbDogVGVtcGVyYXR1cmVDb250cm9sLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplKV0KZW51bSBTdGF0ZUV2ZW50IHsKICAgIEluaXQgewogICAgICAgIGhhcnZlc3Q6IHUzMiwKICAgICAgICBncmFwZTogU3RyaW5nLAogICAgICAgIG9yaWdpbjogU3RyaW5nLAogICAgfSwKICAgIFRlbXBlcmF0dXJlQ29udHJvbCB7CiAgICAgICAgdGVtcGVyYXR1cmU6IGYzMiwKICAgICAgICB0aW1lc3RhbXA6IHUzMiwKICAgIH0sCiAgICBPcmdhbmljQ2VydGlmaWNhdGlvbiB7CiAgICAgICAgZmVydGlsaXplcnNfY29udHJvbDogYm9vbCwKICAgICAgICBwZXN0aWNpZGVzX2NvbnRyb2w6IGJvb2wsCiAgICAgICAgYW5hbHl0aWNzOiBib29sLAogICAgICAgIGFkZGl0aW9uYWxfaW5mbzogU3RyaW5nLAogICAgfSwKfQoKY29uc3QgVEVNUEVSQVRVUkVfUkFOR0U6IChmMzIsIGYzMikgPSAoMTAuMCwgMTYuMCk7CgojW25vX21hbmdsZV0KcHViIHVuc2FmZSBmbiBtYWluX2Z1bmN0aW9uKHN0YXRlX3B0cjogaTMyLCBldmVudF9wdHI6IGkzMiwgaXNfb3duZXI6IGkzMikgLT4gdTMyIHsKICAgIHNkazo6ZXhlY3V0ZV9jb250cmFjdChzdGF0ZV9wdHIsIGV2ZW50X3B0ciwgaXNfb3duZXIsIGNvbnRyYWN0X2xvZ2ljKQp9CgpmbiBjb250cmFjdF9sb2dpYygKICAgIGNvbnRleHQ6ICZzZGs6OkNvbnRleHQ8U3RhdGUsIFN0YXRlRXZlbnQ+LAogICAgY29udHJhY3RfcmVzdWx0OiAmbXV0IHNkazo6Q29udHJhY3RSZXN1bHQ8U3RhdGU+LAopIHsKICAgIGxldCBzdGF0ZSA9ICZtdXQgY29udHJhY3RfcmVzdWx0LmZpbmFsX3N0YXRlOwogICAgbWF0Y2ggJmNvbnRleHQuZXZlbnQgewogICAgICAgIFN0YXRlRXZlbnQ6OkluaXQgewogICAgICAgICAgICBoYXJ2ZXN0LAogICAgICAgICAgICBncmFwZSwKICAgICAgICAgICAgb3JpZ2luLAogICAgICAgIH0gPT4gewogICAgICAgICAgICBpZiBjb250ZXh0LmlzX293bmVyICYmICFjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZSkgewogICAgICAgICAgICAgICAgbGV0IGdyYXBlID0gbWF0Y2ggZ3JhcGUuYXNfc3RyKCkgewogICAgICAgICAgICAgICAgICAgICJDYWJlcm5ldFNhdXZpZ25vbiIgPT4gU29tZShHcmFwZTo6Q2FiZXJuZXRTYXV2aWdub24pLAogICAgICAgICAgICAgICAgICAgICJDaGFyZG9ubmF5IiA9PiBTb21lKEdyYXBlOjpDaGFyZG9ubmF5KSwKICAgICAgICAgICAgICAgICAgICAiUGlub3ROb2lyIiA9PiBTb21lKEdyYXBlOjpQaW5vdE5vaXIpLAogICAgICAgICAgICAgICAgICAgIF8gPT4gTm9uZSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBpZiBncmFwZS5pc19zb21lKCkgewogICAgICAgICAgICAgICAgICAgIHN0YXRlLmhhcnZlc3QgPSAqaGFydmVzdDsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ncmFwZSA9IGdyYXBlOwogICAgICAgICAgICAgICAgICAgIHN0YXRlLm9yaWdpbiA9IG9yaWdpbi50b19zdHJpbmcoKTsKICAgICAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgU3RhdGVFdmVudDo6VGVtcGVyYXR1cmVDb250cm9sIHsKICAgICAgICAgICAgdGVtcGVyYXR1cmUsCiAgICAgICAgICAgIHRpbWVzdGFtcCwKICAgICAgICB9ID0+IHsKICAgICAgICAgICAgaWYgY29udGV4dC5pc19vd25lciAmJiBjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZSkgewogICAgICAgICAgICAgICAgaWYgY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UoKnRlbXBlcmF0dXJlKQogICAgICAgICAgICAgICAgICAgICYmIHN0YXRlLnRlbXBlcmF0dXJlX2NvbnRyb2wudGVtcGVyYXR1cmVfb2sKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9sLmxhc3RfY2hlY2sgPSAqdGltZXN0YW1wOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9sLnRlbXBlcmF0dXJlX29rID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGVtcGVyYXR1cmVfY29udHJvbC5sYXN0X2NoZWNrID0gKnRpbWVzdGFtcDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBTdGF0ZUV2ZW50OjpPcmdhbmljQ2VydGlmaWNhdGlvbiB7CiAgICAgICAgICAgIGZlcnRpbGl6ZXJzX2NvbnRyb2wsCiAgICAgICAgICAgIHBlc3RpY2lkZXNfY29udHJvbCwKICAgICAgICAgICAgYW5hbHl0aWNzLAogICAgICAgICAgICBhZGRpdGlvbmFsX2luZm8sCiAgICAgICAgfSA9PiB7CiAgICAgICAgICAgIGlmIGNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlKSB7CiAgICAgICAgICAgICAgICBtYXRjaCBzdGF0ZS5vcmdhbmljX2NlcnRpZmllZCB7CiAgICAgICAgICAgICAgICAgICAgU29tZShvcmdhbmljX2NlcmlmaWVkKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9yZ2FuaWNfY2VyaWZpZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmICFjaGVja19pc19vcmdhbmljKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpmZXJ0aWxpemVyc19jb250cm9sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpwZXN0aWNpZGVzX2NvbnRyb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKmFuYWx5dGljcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBOb25lID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2hlY2tfaXNfb3JnYW5pYygqZmVydGlsaXplcnNfY29udHJvbCwgKnBlc3RpY2lkZXNfY29udHJvbCwgKmFuYWx5dGljcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5hcHByb3ZhbF9yZXF1aXJlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCmZuIGNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlOiAmU3RhdGUpIC0+IGJvb2wgewogICAgbGV0IGluaXRpYWxfZ3JhcGUgPSBtYXRjaCBzdGF0ZS5ncmFwZSB7CiAgICAgICAgU29tZShfKSA9PiBmYWxzZSwKICAgICAgICBOb25lID0+IHRydWUsCiAgICB9OwogICAgaWYgc3RhdGUuaGFydmVzdCA9PSAwICYmIGluaXRpYWxfZ3JhcGUgJiYgc3RhdGUub3JpZ2luID09IGZvcm1hdCEoIiIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKfQoKZm4gY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UodGVtcGVyYXR1cmU6IGYzMikgLT4gYm9vbCB7CiAgICBpZiB0ZW1wZXJhdHVyZSA+PSBURU1QRVJBVFVSRV9SQU5HRS4wICYmIHRlbXBlcmF0dXJlIDw9IFRFTVBFUkFUVVJFX1JBTkdFLjEgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgcmV0dXJuIGZhbHNlOwp9CgpmbiBjaGVja19pc19vcmdhbmljKGZlcnRpbGl6ZXJzX2NvbnRyb2w6IGJvb2wsIHBlc3RpY2lkZXNfY29udHJvbDogYm9vbCwgYW5hbHl0aWNzOiBib29sKSAtPiBib29sIHsKICAgIGlmIGZlcnRpbGl6ZXJzX2NvbnRyb2wgJiYgcGVzdGljaWRlc19jb250cm9sICYmIGFuYWx5dGljcyB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0="\n            },\n            "id": "Wine",\n            "initial_value": {\n                "grape": null,\n                "harvest": 0,\n                "organic_certified": null,\n                "origin": "",\n                "temperature_control": {\n                    "last_check": 0,\n                    "temperature_ok": true\n                }\n            },\n            "schema": {\n                "additionalProperties": false,\n                "description": "Representationofabottleofwine",\n                "properties": {\n                    "grape": {\n                        "description": "Typeofgrape",\n                        "enum": [\n                            "CabernetSauvignon",\n                            "Chardonnay",\n                            "PinotNoir",\n                            null\n                        ],\n                        "type": [\n                            "string",\n                            "null"\n                        ]\n                    },\n                    "harvest": {\n                        "description": "Harvestnumber",\n                        "type": "integer"\n                    },\n                    "organic_certified": {\n                        "description": "Certificateauthenticatingwhetheritisorganicornot",\n                        "type": [\n                            "boolean",\n                            "null"\n                        ]\n                    },\n                    "origin": {\n                        "description": "Originofthegrape",\n                        "type": "string"\n                    },\n                    "temperature_control": {\n                        "additionalProperties": false,\n                        "description": "Valuestobechangedinthetemperaturecontrolevent",\n                        "properties": {\n                            "last_check": {\n                                "description": "Timestampoflastcheck",\n                                "type": "integer"\n                            },\n                            "temperature_ok": {\n                                "description": "Valuethatcorroborateswhetherthewinecoldchainhasbeencompliedwith",\n                                "type": "boolean"\n                            }\n                        },\n                        "required": [\n                            "last_check",\n                            "temperature_ok"\n                        ],\n                        "type": "object"\n                    }\n                },\n                "required": [\n                    "harvest",\n                    "grape",\n                    "origin",\n                    "organic_certified",\n                    "temperature_control"\n                ],\n                "type": "object"\n            }\n        }\n    }\n]\n')),(0,A.kt)("p",null,"Now, it's time to call the method of the governance contract responsible for updating its properties. To do this, we will execute the following:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},'curl --request POST \'http://localhost:3000/api/event-requests\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n    "request": {\n        "Fact": {\n            "subject_id": {{GOVERNANCE-ID}},\n            "payload": {\n                "Patch": {\n                    "data": [\n                        {\n                            "op": "add",\n                            "path": "/policies/1",\n                            "value": {\n                                "approve": {\n                                    "quorum": "MAJORITY"\n                                },\n                                "evaluate": {\n                                    "quorum": "MAJORITY"\n                                },\n                                "id": "Wine",\n                                "validate": {\n                                    "quorum": "MAJORITY"\n                                }\n                            }\n                        },\n                        {\n                            "op": "add",\n                            "path": "/schemas/0",\n                            "value": {\n                                "contract": {\n                                    "raw": "dXNlIHRhcGxlX3NjX3J1c3QgYXMgc2RrOwp1c2Ugc2VyZGU6OntEZXNlcmlhbGl6ZSwgU2VyaWFsaXplfTsKCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lLCBQYXJ0aWFsRXEpXSAKZW51bSBHcmFwZSB7CiAgICBDYWJlcm5ldFNhdXZpZ25vbiwKICAgIENoYXJkb25uYXksCiAgICBQaW5vdE5vaXIsCn0KCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lKV0Kc3RydWN0IFRlbXBlcmF0dXJlQ29udHJvbCB7CiAgICBwdWIgbGFzdF9jaGVjazogdTMyLAogICAgcHViIHRlbXBlcmF0dXJlX29rOiBib29sLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplLCBDbG9uZSldCnN0cnVjdCBTdGF0ZSB7CiAgICBwdWIgaGFydmVzdDogdTMyLAogICAgcHViIGdyYXBlOiBPcHRpb248R3JhcGU+LAogICAgcHViIG9yaWdpbjogU3RyaW5nLAogICAgcHViIG9yZ2FuaWNfY2VydGlmaWVkOiBPcHRpb248Ym9vbD4sCiAgICBwdWIgdGVtcGVyYXR1cmVfY29udHJvbDogVGVtcGVyYXR1cmVDb250cm9sLAp9CgojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplKV0KZW51bSBTdGF0ZUV2ZW50IHsKICAgIEluaXQgewogICAgICAgIGhhcnZlc3Q6IHUzMiwKICAgICAgICBncmFwZTogU3RyaW5nLAogICAgICAgIG9yaWdpbjogU3RyaW5nLAogICAgfSwKICAgIFRlbXBlcmF0dXJlQ29udHJvbCB7CiAgICAgICAgdGVtcGVyYXR1cmU6IGYzMiwKICAgICAgICB0aW1lc3RhbXA6IHUzMiwKICAgIH0sCiAgICBPcmdhbmljQ2VydGlmaWNhdGlvbiB7CiAgICAgICAgZmVydGlsaXplcnNfY29udHJvbDogYm9vbCwKICAgICAgICBwZXN0aWNpZGVzX2NvbnRyb2w6IGJvb2wsCiAgICAgICAgYW5hbHl0aWNzOiBib29sLAogICAgICAgIGFkZGl0aW9uYWxfaW5mbzogU3RyaW5nLAogICAgfSwKfQoKY29uc3QgVEVNUEVSQVRVUkVfUkFOR0U6IChmMzIsIGYzMikgPSAoMTAuMCwgMTYuMCk7CgojW25vX21hbmdsZV0KcHViIHVuc2FmZSBmbiBtYWluX2Z1bmN0aW9uKHN0YXRlX3B0cjogaTMyLCBldmVudF9wdHI6IGkzMiwgaXNfb3duZXI6IGkzMikgLT4gdTMyIHsKICAgIHNkazo6ZXhlY3V0ZV9jb250cmFjdChzdGF0ZV9wdHIsIGV2ZW50X3B0ciwgaXNfb3duZXIsIGNvbnRyYWN0X2xvZ2ljKQp9CgpmbiBjb250cmFjdF9sb2dpYygKICAgIGNvbnRleHQ6ICZzZGs6OkNvbnRleHQ8U3RhdGUsIFN0YXRlRXZlbnQ+LAogICAgY29udHJhY3RfcmVzdWx0OiAmbXV0IHNkazo6Q29udHJhY3RSZXN1bHQ8U3RhdGU+LAopIHsKICAgIGxldCBzdGF0ZSA9ICZtdXQgY29udHJhY3RfcmVzdWx0LmZpbmFsX3N0YXRlOwogICAgbWF0Y2ggJmNvbnRleHQuZXZlbnQgewogICAgICAgIFN0YXRlRXZlbnQ6OkluaXQgewogICAgICAgICAgICBoYXJ2ZXN0LAogICAgICAgICAgICBncmFwZSwKICAgICAgICAgICAgb3JpZ2luLAogICAgICAgIH0gPT4gewogICAgICAgICAgICBpZiBjb250ZXh0LmlzX293bmVyICYmICFjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZSkgewogICAgICAgICAgICAgICAgbGV0IGdyYXBlID0gbWF0Y2ggZ3JhcGUuYXNfc3RyKCkgewogICAgICAgICAgICAgICAgICAgICJDYWJlcm5ldFNhdXZpZ25vbiIgPT4gU29tZShHcmFwZTo6Q2FiZXJuZXRTYXV2aWdub24pLAogICAgICAgICAgICAgICAgICAgICJDaGFyZG9ubmF5IiA9PiBTb21lKEdyYXBlOjpDaGFyZG9ubmF5KSwKICAgICAgICAgICAgICAgICAgICAiUGlub3ROb2lyIiA9PiBTb21lKEdyYXBlOjpQaW5vdE5vaXIpLAogICAgICAgICAgICAgICAgICAgIF8gPT4gTm9uZSwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBpZiBncmFwZS5pc19zb21lKCkgewogICAgICAgICAgICAgICAgICAgIHN0YXRlLmhhcnZlc3QgPSAqaGFydmVzdDsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS5ncmFwZSA9IGdyYXBlOwogICAgICAgICAgICAgICAgICAgIHN0YXRlLm9yaWdpbiA9IG9yaWdpbi50b19zdHJpbmcoKTsKICAgICAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgU3RhdGVFdmVudDo6VGVtcGVyYXR1cmVDb250cm9sIHsKICAgICAgICAgICAgdGVtcGVyYXR1cmUsCiAgICAgICAgICAgIHRpbWVzdGFtcCwKICAgICAgICB9ID0+IHsKICAgICAgICAgICAgaWYgY29udGV4dC5pc19vd25lciAmJiBjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZSkgewogICAgICAgICAgICAgICAgaWYgY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UoKnRlbXBlcmF0dXJlKQogICAgICAgICAgICAgICAgICAgICYmIHN0YXRlLnRlbXBlcmF0dXJlX2NvbnRyb2wudGVtcGVyYXR1cmVfb2sKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9sLmxhc3RfY2hlY2sgPSAqdGltZXN0YW1wOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9sLnRlbXBlcmF0dXJlX29rID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGVtcGVyYXR1cmVfY29udHJvbC5sYXN0X2NoZWNrID0gKnRpbWVzdGFtcDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBTdGF0ZUV2ZW50OjpPcmdhbmljQ2VydGlmaWNhdGlvbiB7CiAgICAgICAgICAgIGZlcnRpbGl6ZXJzX2NvbnRyb2wsCiAgICAgICAgICAgIHBlc3RpY2lkZXNfY29udHJvbCwKICAgICAgICAgICAgYW5hbHl0aWNzLAogICAgICAgICAgICBhZGRpdGlvbmFsX2luZm8sCiAgICAgICAgfSA9PiB7CiAgICAgICAgICAgIGlmIGNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlKSB7CiAgICAgICAgICAgICAgICBtYXRjaCBzdGF0ZS5vcmdhbmljX2NlcnRpZmllZCB7CiAgICAgICAgICAgICAgICAgICAgU29tZShvcmdhbmljX2NlcmlmaWVkKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9yZ2FuaWNfY2VyaWZpZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmICFjaGVja19pc19vcmdhbmljKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpmZXJ0aWxpemVyc19jb250cm9sLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpwZXN0aWNpZGVzX2NvbnRyb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKmFuYWx5dGljcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBOb25lID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2hlY2tfaXNfb3JnYW5pYygqZmVydGlsaXplcnNfY29udHJvbCwgKnBlc3RpY2lkZXNfY29udHJvbCwgKmFuYWx5dGljcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5hcHByb3ZhbF9yZXF1aXJlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCmZuIGNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlOiAmU3RhdGUpIC0+IGJvb2wgewogICAgbGV0IGluaXRpYWxfZ3JhcGUgPSBtYXRjaCBzdGF0ZS5ncmFwZSB7CiAgICAgICAgU29tZShfKSA9PiBmYWxzZSwKICAgICAgICBOb25lID0+IHRydWUsCiAgICB9OwogICAgaWYgc3RhdGUuaGFydmVzdCA9PSAwICYmIGluaXRpYWxfZ3JhcGUgJiYgc3RhdGUub3JpZ2luID09IGZvcm1hdCEoIiIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKfQoKZm4gY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UodGVtcGVyYXR1cmU6IGYzMikgLT4gYm9vbCB7CiAgICBpZiB0ZW1wZXJhdHVyZSA+PSBURU1QRVJBVFVSRV9SQU5HRS4wICYmIHRlbXBlcmF0dXJlIDw9IFRFTVBFUkFUVVJFX1JBTkdFLjEgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgcmV0dXJuIGZhbHNlOwp9CgpmbiBjaGVja19pc19vcmdhbmljKGZlcnRpbGl6ZXJzX2NvbnRyb2w6IGJvb2wsIHBlc3RpY2lkZXNfY29udHJvbDogYm9vbCwgYW5hbHl0aWNzOiBib29sKSAtPiBib29sIHsKICAgIGlmIGZlcnRpbGl6ZXJzX2NvbnRyb2wgJiYgcGVzdGljaWRlc19jb250cm9sICYmIGFuYWx5dGljcyB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0="\n                                },\n                                "id": "Wine",\n                                "initial_value": {\n                                    "grape": null,\n                                    "harvest": 0,\n                                    "organic_certified": null,\n                                    "origin": "",\n                                    "temperature_control": {\n                                        "last_check": 0,\n                                        "temperature_ok": true\n                                    }\n                                },\n                                "schema": {\n                                    "additionalProperties": false,\n                                    "description": "Representationofabottleofwine",\n                                    "properties": {\n                                        "grape": {\n                                            "description": "Typeofgrape",\n                                            "enum": [\n                                                "CabernetSauvignon",\n                                                "Chardonnay",\n                                                "PinotNoir",\n                                                null\n                                            ],\n                                            "type": [\n                                                "string",\n                                                "null"\n                                            ]\n                                        },\n                                        "harvest": {\n                                            "description": "Harvestnumber",\n                                            "type": "integer"\n                                        },\n                                        "organic_certified": {\n                                            "description": "Certificateauthenticatingwhetheritisorganicornot",\n                                            "type": [\n                                                "boolean",\n                                                "null"\n                                            ]\n                                        },\n                                        "origin": {\n                                            "description": "Originofthegrape",\n                                            "type": "string"\n                                        },\n                                        "temperature_control": {\n                                            "additionalProperties": false,\n                                            "description": "Valuestobechangedinthetemperaturecontrolevent",\n                                            "properties": {\n                                                "last_check": {\n                                                    "description": "Timestampoflastcheck",\n                                                    "type": "integer"\n                                                },\n                                                "temperature_ok": {\n                                                    "description": "Valuethatcorroborateswhetherthewinecoldchainhasbeencompliedwith",\n                                                    "type": "boolean"\n                                                }\n                                            },\n                                            "required": [\n                                                "last_check",\n                                                "temperature_ok"\n                                            ],\n                                            "type": "object"\n                                        }\n                                    },\n                                    "required": [\n                                        "harvest",\n                                        "grape",\n                                        "origin",\n                                        "organic_certified",\n                                        "temperature_control"\n                                    ],\n                                    "type": "object"\n                                }\n                            }\n                        }\n                    ]\n                }\n            }\n        }\n    }\n}\'\n')),(0,A.kt)("p",null,"Once the event is emitted, we need to obtain the new update request. To do this, we run the following:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},"curl --request GET 'http://localhost:3000/api/approval-requests?status=Pending'\n")),(0,A.kt)("p",null,"We copy the value of the ",(0,A.kt)("inlineCode",{parentName:"p"},"id")," field and accept the governance update request:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},"curl --request PATCH 'http://localhost:3000/api/approval-requests/{{PREVIUS-ID}}' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\"state\": \"RespondedAccepted\"}'\n")),(0,A.kt)("p",null,"Finally, we query the governance to verify that the change has been successfully applied. If everything has gone according to plan, it should now have an ",(0,A.kt)("inlineCode",{parentName:"p"},"sn")," of 2, and the new policy, schema, initial state for ",(0,A.kt)("em",{parentName:"p"},"Wine")," subjects, and the smart contract should be present:"),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},"curl --request GET 'http://localhost:3000/api/subjects/{{GOVERNANCE-ID}}'\n")),(0,A.kt)("details",null,(0,A.kt)("summary",null,"Click to look at the full governance."),(0,A.kt)("pre",null,(0,A.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "subject_id": {{GOVERNANCE-ID}},\n    "governance_id": "",\n    "sn": 2,\n    "public_key": "E8tVWEasubIp7P9fzk_HttNCsABymV9m9xEPAfr-QV7M",\n    "namespace": "",\n    "name": "wine_track",\n    "schema_id": "governance",\n    "owner": "EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs",\n    "creator": "EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs",\n    "properties": {\n        "members": [\n        {\n            "id": "EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs",\n            "name": "WPO"\n        }\n        ],\n        "policies": [\n        {\n            "approve": {\n            "quorum": "MAJORITY"\n            },\n            "evaluate": {\n            "quorum": "MAJORITY"\n            },\n            "id": "governance",\n            "validate": {\n            "quorum": "MAJORITY"\n            }\n        },\n        {\n            "approve": {\n            "quorum": "MAJORITY"\n            },\n            "evaluate": {\n            "quorum": "MAJORITY"\n            },\n            "id": "Wine",\n            "validate": {\n            "quorum": "MAJORITY"\n            }\n        }\n        ],\n        "roles": [\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n            "ID": "governance"\n            },\n            "who": "MEMBERS"\n        },\n        {\n            "namespace": "",\n            "role": "APPROVER",\n            "schema": {\n            "ID": "governance"\n            },\n            "who": {\n            "NAME": "WPO"\n            }\n        }\n        ],\n        "schemas": [\n        {\n            "contract": {\n            "raw": "dXNlIHRhcGxlX3NjX3J1c3QgYXMgc2RrOw0KdXNlIHNlcmRlOjp7RGVzZXJpYWxpemUsIFNlcmlhbGl6ZX07DQoNCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lLCBQYXJ0aWFsRXEpXSANCmVudW0gR3JhcGUgew0KICAgIENhYmVybmV0U2F1dmlnbm9uLA0KICAgIENoYXJkb25uYXksDQogICAgUGlub3ROb2lyLA0KfQ0KDQojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplLCBDbG9uZSldDQpzdHJ1Y3QgVGVtcGVyYXR1cmVDb250cm9sIHsNCiAgICBwdWIgbGFzdF9jaGVjazogdTMyLA0KICAgIHB1YiB0ZW1wZXJhdHVyZV9vazogYm9vbCwNCn0NCg0KI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUpXQ0Kc3RydWN0IFN0YXRlIHsNCiAgICBwdWIgaGFydmVzdDogdTMyLA0KICAgIHB1YiBncmFwZTogT3B0aW9uPEdyYXBlPiwNCiAgICBwdWIgb3JpZ2luOiBTdHJpbmcsDQogICAgcHViIG9yZ2FuaWNfY2VydGlmaWVkOiBPcHRpb248Ym9vbD4sDQogICAgcHViIHRlbXBlcmF0dXJlX2NvbnRyb2w6IFRlbXBlcmF0dXJlQ29udHJvbCwNCn0NCg0KI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSldDQplbnVtIFN0YXRlRXZlbnQgew0KICAgIEluaXQgew0KICAgICAgICBoYXJ2ZXN0OiB1MzIsDQogICAgICAgIGdyYXBlOiBTdHJpbmcsDQogICAgICAgIG9yaWdpbjogU3RyaW5nLA0KICAgIH0sDQogICAgVGVtcGVyYXR1cmVDb250cm9sIHsNCiAgICAgICAgdGVtcGVyYXR1cmU6IGYzMiwNCiAgICAgICAgdGltZXN0YW1wOiB1MzIsDQogICAgfSwNCiAgICBPcmdhbmljQ2VydGlmaWNhdGlvbiB7DQogICAgICAgIGZlcnRpbGl6ZXJzX2NvbnRyb2w6IGJvb2wsDQogICAgICAgIHBlc3RpY2lkZXNfY29udHJvbDogYm9vbCwNCiAgICAgICAgYW5hbHl0aWNzOiBib29sLA0KICAgICAgICBhZGRpdGlvbmFsX2luZm86IFN0cmluZywNCiAgICB9LA0KfQ0KDQpjb25zdCBURU1QRVJBVFVSRV9SQU5HRTogKGYzMiwgZjMyKSA9ICgxMC4wLCAxNi4wKTsNCg0KI1tub19tYW5nbGVdDQpwdWIgdW5zYWZlIGZuIG1haW5fZnVuY3Rpb24oc3RhdGVfcHRyOiBpMzIsIGV2ZW50X3B0cjogaTMyLCBpc19vd25lcjogaTMyKSAtPiB1MzIgew0KICAgIHNkazo6ZXhlY3V0ZV9jb250cmFjdChzdGF0ZV9wdHIsIGV2ZW50X3B0ciwgaXNfb3duZXIsIGNvbnRyYWN0X2xvZ2ljKQ0KfQ0KDQpmbiBjb250cmFjdF9sb2dpYygNCiAgICBjb250ZXh0OiAmc2RrOjpDb250ZXh0PFN0YXRlLCBTdGF0ZUV2ZW50PiwNCiAgICBjb250cmFjdF9yZXN1bHQ6ICZtdXQgc2RrOjpDb250cmFjdFJlc3VsdDxTdGF0ZT4sDQopIHsNCiAgICBsZXQgc3RhdGUgPSAmbXV0IGNvbnRyYWN0X3Jlc3VsdC5maW5hbF9zdGF0ZTsNCiAgICBtYXRjaCAmY29udGV4dC5ldmVudCB7DQogICAgICAgIFN0YXRlRXZlbnQ6OkluaXQgew0KICAgICAgICAgICAgaGFydmVzdCwNCiAgICAgICAgICAgIGdyYXBlLA0KICAgICAgICAgICAgb3JpZ2luLA0KICAgICAgICB9ID0+IHsNCiAgICAgICAgICAgIGlmIGNvbnRleHQuaXNfb3duZXIgJiYgIWNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlKSB7IC8vIFNvbG8gbG8gcHVlZGRlIGhhY2VyIGVsIHByb3BpZXRhcmlvw6cNCiAgICAgICAgICAgICAgICBsZXQgZ3JhcGUgPSBtYXRjaCBncmFwZS5hc19zdHIoKSB7DQogICAgICAgICAgICAgICAgICAgICJDYWJlcm5ldFNhdXZpZ25vbiIgPT4gU29tZShHcmFwZTo6Q2FiZXJuZXRTYXV2aWdub24pLA0KICAgICAgICAgICAgICAgICAgICAiQ2hhcmRvbm5heSIgPT4gU29tZShHcmFwZTo6Q2hhcmRvbm5heSksDQogICAgICAgICAgICAgICAgICAgICJQaW5vdE5vaXIiID0+IFNvbWUoR3JhcGU6OlBpbm90Tm9pciksDQogICAgICAgICAgICAgICAgICAgIF8gPT4gTm9uZSwNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGlmIGdyYXBlLmlzX3NvbWUoKSB7DQogICAgICAgICAgICAgICAgICAgIHN0YXRlLmhhcnZlc3QgPSAqaGFydmVzdDsNCiAgICAgICAgICAgICAgICAgICAgc3RhdGUuZ3JhcGUgPSBncmFwZTsNCiAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JpZ2luID0gb3JpZ2luLnRvX3N0cmluZygpOw0KICAgICAgICAgICAgICAgICAgICBjb250cmFjdF9yZXN1bHQuc3VjY2VzcyA9IHRydWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIFN0YXRlRXZlbnQ6OlRlbXBlcmF0dXJlQ29udHJvbCB7DQogICAgICAgICAgICB0ZW1wZXJhdHVyZSwNCiAgICAgICAgICAgIHRpbWVzdGFtcCwNCiAgICAgICAgfSA9PiB7DQogICAgICAgICAgICBpZiBjb250ZXh0LmlzX293bmVyICYmIGNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlKSB7DQogICAgICAgICAgICAgICAgaWYgY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UoKnRlbXBlcmF0dXJlKQ0KICAgICAgICAgICAgICAgICAgICAmJiBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9sLnRlbXBlcmF0dXJlX29rDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9sLmxhc3RfY2hlY2sgPSAqdGltZXN0YW1wOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHN0YXRlLnRlbXBlcmF0dXJlX2NvbnRyb2wudGVtcGVyYXR1cmVfb2sgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGVtcGVyYXR1cmVfY29udHJvbC5sYXN0X2NoZWNrID0gKnRpbWVzdGFtcDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LnN1Y2Nlc3MgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIFN0YXRlRXZlbnQ6Ok9yZ2FuaWNDZXJ0aWZpY2F0aW9uIHsNCiAgICAgICAgICAgIGZlcnRpbGl6ZXJzX2NvbnRyb2wsDQogICAgICAgICAgICBwZXN0aWNpZGVzX2NvbnRyb2wsDQogICAgICAgICAgICBhbmFseXRpY3MsDQogICAgICAgICAgICBhZGRpdGlvbmFsX2luZm8sDQogICAgICAgIH0gPT4gew0KICAgICAgICAgICAgaWYgY2hlY2tfc3ViamVjdF9oYXNfYmVlbl9pbml0aWF0ZWQoc3RhdGUpIHsNCiAgICAgICAgICAgICAgICBtYXRjaCBzdGF0ZS5vcmdhbmljX2NlcnRpZmllZCB7DQogICAgICAgICAgICAgICAgICAgIFNvbWUob3JnYW5pY19jZXJpZmllZCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3JnYW5pY19jZXJpZmllZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmICFjaGVja19pc19vcmdhbmljKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqZmVydGlsaXplcnNfY29udHJvbCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKnBlc3RpY2lkZXNfY29udHJvbCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKmFuYWx5dGljcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBOb25lID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNoZWNrX2lzX29yZ2FuaWMoKmZlcnRpbGl6ZXJzX2NvbnRyb2wsICpwZXN0aWNpZGVzX2NvbnRyb2wsICphbmFseXRpY3MpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5vcmdhbmljX2NlcnRpZmllZCA9IFNvbWUodHJ1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLm9yZ2FuaWNfY2VydGlmaWVkID0gU29tZShmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LnN1Y2Nlc3MgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpmbiBjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZTogJlN0YXRlKSAtPiBib29sIHsNCiAgICBsZXQgaW5pdGlhbF9ncmFwZSA9IG1hdGNoIHN0YXRlLmdyYXBlIHsNCiAgICAgICAgU29tZShfKSA9PiBmYWxzZSwNCiAgICAgICAgTm9uZSA9PiB0cnVlLA0KICAgIH07DQogICAgaWYgc3RhdGUuaGFydmVzdCA9PSAwICYmIGluaXRpYWxfZ3JhcGUgJiYgc3RhdGUub3JpZ2luID09IGZvcm1hdCEoIiIpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICByZXR1cm4gdHJ1ZTsNCn0NCg0KZm4gY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UodGVtcGVyYXR1cmU6IGYzMikgLT4gYm9vbCB7DQogICAgaWYgdGVtcGVyYXR1cmUgPj0gVEVNUEVSQVRVUkVfUkFOR0UuMCAmJiB0ZW1wZXJhdHVyZSA8PSBURU1QRVJBVFVSRV9SQU5HRS4xIHsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIHJldHVybiBmYWxzZTsNCn0NCg0KZm4gY2hlY2tfaXNfb3JnYW5pYyhmZXJ0aWxpemVyc19jb250cm9sOiBib29sLCBwZXN0aWNpZGVzX2NvbnRyb2w6IGJvb2wsIGFuYWx5dGljczogYm9vbCkgLT4gYm9vbCB7DQogICAgaWYgZmVydGlsaXplcnNfY29udHJvbCAmJiBwZXN0aWNpZGVzX2NvbnRyb2wgJiYgYW5hbHl0aWNzIHsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIHJldHVybiBmYWxzZTsNCn0="\n            },\n            "id": "Wine",\n            "initial_value": {\n            "grape": null,\n            "harvest": 0,\n            "organic_certified": null,\n            "origin": "",\n            "temperature_control": {\n                "last_check": 0,\n                "temperature_ok": true\n            }\n            },\n            "schema": {\n            "additionalProperties": false,\n            "description": "Representation of a bottle of wine",\n            "properties": {\n                "grape": {\n                "description": "Type of grape",\n                "enum": [\n                    "CabernetSauvignon",\n                    "Chardonnay",\n                    "PinotNoir",\n                    null\n                ],\n                "type": [\n                    "string",\n                    "null"\n                ]\n                },\n                "harvest": {\n                "description": "Harvest number",\n                "type": "integer"\n                },\n                "organic_certified": {\n                "description": "Certificate authenticating whether it is organic or not",\n                "type": [\n                    "boolean",\n                    "null"\n                ]\n                },\n                "origin": {\n                "description": "Origin of the grape",\n                "type": "string"\n                },\n                "temperature_control": {\n                "additionalProperties": false,\n                "description": "Values to be changed in the temperature control event",\n                "properties": {\n                    "last_check": {\n                    "description": "Timestamp of last check",\n                    "type": "integer"\n                    },\n                    "temperature_ok": {\n                    "description": "Value that corroborates whether the wine cold chain has been complied with",\n                    "type": "boolean"\n                    }\n                },\n                "required": [\n                    "last_check",\n                    "temperature_ok"\n                ],\n                "type": "object"\n                }\n            },\n            "required": [\n                "harvest",\n                "grape",\n                "origin",\n                "organic_certified",\n                "temperature_control"\n            ],\n            "type": "object"\n            }\n        }\n        ]\n    },\n    "active": true\n}\n'))))}o.isMDXComponent=!0}}]);