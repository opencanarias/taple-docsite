"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[8791],{3905:(e,n,a)=>{a.d(n,{Zo:()=>c,kt:()=>A});var t=a(67294);function o(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function l(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function r(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?l(Object(a),!0).forEach((function(n){o(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function s(e,n){if(null==e)return{};var a,t,o=function(e,n){if(null==e)return{};var a,t,o={},l=Object.keys(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||(o[a]=e[a]);return o}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var i=t.createContext({}),g=function(e){var n=t.useContext(i),a=n;return e&&(a="function"==typeof e?e(n):r(r({},n),e)),a},c=function(e){var n=g(e.components);return t.createElement(i.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},I=t.forwardRef((function(e,n){var a=e.components,o=e.mdxType,l=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),I=g(a),A=o,m=I["".concat(i,".").concat(A)]||I[A]||p[A]||l;return a?t.createElement(m,r(r({ref:n},c),{},{components:a})):t.createElement(m,r({ref:n},c))}));function A(e,n){var a=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var l=a.length,r=new Array(l);r[0]=I;var s={};for(var i in n)hasOwnProperty.call(n,i)&&(s[i]=n[i]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var g=2;g<l;g++)r[g]=a[g];return t.createElement.apply(null,r)}return t.createElement.apply(null,a)}I.displayName="MDXCreateElement"},18701:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>i,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>g});var t=a(87462),o=(a(67294),a(3905));const l={},r="Segmentation",s={unversionedId:"build/assets-traceability/segmentation",id:"version-0.3/build/assets-traceability/segmentation",title:"Segmentation",description:"Currently, we have witnesses and approvers for the Wine subjects. However, a problem arises with one of the nodes we added, SFO, as it is specific to Spain, and we do not want it to influence decisions made in other countries.",source:"@site/versioned_docs/version-0.3/build/assets-traceability/segmentation.md",sourceDirName:"build/assets-traceability",slug:"/build/assets-traceability/segmentation",permalink:"/taple-docsite/docs/build/assets-traceability/segmentation",draft:!1,tags:[],version:"0.3",lastUpdatedAt:1696933252,formattedLastUpdatedAt:"Oct 10, 2023",frontMatter:{},sidebar:"buildSidebar",previous:{title:"Transfers",permalink:"/taple-docsite/docs/build/assets-traceability/transfers"},next:{title:"Changing policies",permalink:"/taple-docsite/docs/build/assets-traceability/changing-policies"}},i={},g=[],c={toc:g};function p(e){let{components:n,...a}=e;return(0,o.kt)("wrapper",(0,t.Z)({},c,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"segmentation"},"Segmentation"),(0,o.kt)("p",null,"Currently, we have witnesses and approvers for the ",(0,o.kt)("em",{parentName:"p"},"Wine")," subjects. However, a problem arises with one of the nodes we added, ",(0,o.kt)("strong",{parentName:"p"},"SFO"),", as it is specific to Spain, and we do not want it to influence decisions made in other countries."),(0,o.kt)("p",null,"To address this need, the concept of segmentation by namespace emerges. This allows us to define specific permissions and roles for certain namespaces, ensuring that only nodes we consider valid can access specific information based on our interests."),(0,o.kt)("p",null,"With this new knowledge, it is time to continue adapting our use case. ",(0,o.kt)("em",{parentName:"p"},"PremiumWines")," not only has vineyards in Spain but also in France, allowing them to produce bottles with different origins. As we know, in Spain, there is an organization (",(0,o.kt)("strong",{parentName:"p"},"SFO"),") capable of approving the quality analysis of the product, but this is not the case in France, where this responsibility falls on ",(0,o.kt)("strong",{parentName:"p"},"WFO"),"."),(0,o.kt)("p",null,"To achieve what we propose, we need to make some changes to the current schema:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"PremiumWines"),' should be able to create subjects in both countries, so it must be a creator in the "Spain" and "France" namespaces.'),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"WFO")," becomes a witness and approver for wines in both Spain and France."),(0,o.kt)("li",{parentName:"ul"},"External invocations should be allowed in both Spain and France."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("em",{parentName:"li"},"SFO")," will only be an approver and witness for Spanish wines.")),(0,o.kt)("p",null,"First, let's check the roles of the governance before making these changes:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "roles": [\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": "MEMBERS"\n        },\n        {\n            "namespace": "",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "WPO"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "CREATOR",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "PremiumWines"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "VALIDATOR",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "EVALUATOR",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "ISSUER",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": "NOT_MEMBERS"\n        },\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "SFO"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "SFO"\n            }\n        }\n    ]\n}\n')),(0,o.kt)("p",null,"We will make changes to the roles declared in the governance. Here's how the properties should look after the modifications:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "roles": [\n        {\n            "namespace": "",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": "MEMBERS"\n        },\n        {\n            "namespace": "",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "WPO"\n            }\n        },\n        {\n            "namespace": "Spain",\n            "role": "CREATOR",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "PremiumWines"\n            }\n        },\n        {\n            "namespace": "France",\n            "role": "CREATOR",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "PremiumWines"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "VALIDATOR",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "",\n            "role": "EVALUATOR",\n            "schema": {\n                "ID": "governance"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "Spain",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "France",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "Spain",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "France",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "WFO"\n            }\n        },\n        {\n            "namespace": "Spain",\n            "role": "ISSUER",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": "NOT_MEMBERS"\n        },\n        {\n            "namespace": "France",\n            "role": "ISSUER",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": "NOT_MEMBERS"\n        },\n        {\n            "namespace": "Spain",\n            "role": "WITNESS",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "SFO"\n            }\n        },\n        {\n            "namespace": "Spain",\n            "role": "APPROVER",\n            "schema": {\n                "ID": "Wine"\n            },\n            "who": {\n                "NAME": "SFO"\n            }\n        }\n    ]\n}\n')),(0,o.kt)("p",null,"To generate these changes, we will use our tool ",(0,o.kt)("a",{parentName:"p",href:"/taple-docsite/docs/learn/client-tools#taple-patch"},(0,o.kt)("strong",{parentName:"a"},"TAPLE-Patch"))," following this procedure:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Another terminal"',title:'"Another','terminal"':!0},'taple-patch \'{"roles":[{"namespace":"","role":"WITNESS","schema":{"ID":"governance"},"who":"MEMBERS"},{"namespace":"","role":"APPROVER","schema":{"ID":"governance"},"who":{"NAME":"WPO"}},{"namespace":"","role":"CREATOR","schema":{"ID":"Wine"},"who":{"NAME":"PremiumWines"}},{"namespace":"","role":"APPROVER","schema":{"ID":"governance"},"who":{"NAME":"WFO"}},{"namespace":"","role":"VALIDATOR","schema":{"ID":"governance"},"who":{"NAME":"WFO"}},{"namespace":"","role":"EVALUATOR","schema":{"ID":"governance"},"who":{"NAME":"WFO"}},{"namespace":"","role":"WITNESS","schema":{"ID":"Wine"},"who":{"NAME":"WFO"}},{"namespace":"","role":"ISSUER","schema":{"ID":"Wine"},"who":"NOT_MEMBERS"},{"namespace":"","role":"WITNESS","schema":{"ID":"Wine"},"who":{"NAME":"SFO"}},{"namespace":"","role":"APPROVER","schema":{"ID":"Wine"},"who":{"NAME":"SFO"}}]}\' \'{"roles":[{"namespace":"","role":"WITNESS","schema":{"ID":"governance"},"who":"MEMBERS"},{"namespace":"","role":"APPROVER","schema":{"ID":"governance"},"who":{"NAME":"WPO"}},{"namespace":"Spain","role":"CREATOR","schema":{"ID":"Wine"},"who":{"NAME":"PremiumWines"}},{"namespace":"France","role":"CREATOR","schema":{"ID":"Wine"},"who":{"NAME":"PremiumWines"}},{"namespace":"","role":"APPROVER","schema":{"ID":"governance"},"who":{"NAME":"WFO"}},{"namespace":"","role":"VALIDATOR","schema":{"ID":"governance"},"who":{"NAME":"WFO"}},{"namespace":"","role":"EVALUATOR","schema":{"ID":"governance"},"who":{"NAME":"WFO"}},{"namespace":"Spain","role":"WITNESS","schema":{"ID":"Wine"},"who":{"NAME":"WFO"}},{"namespace":"France","role":"WITNESS","schema":{"ID":"Wine"},"who":{"NAME":"WFO"}},{"namespace":"Spain","role":"APPROVER","schema":{"ID":"Wine"},"who":{"NAME":"WFO"}},{"namespace":"France","role":"APPROVER","schema":{"ID":"Wine"},"who":{"NAME":"WFO"}},{"namespace":"Spain","role":"ISSUER","schema":{"ID":"Wine"},"who":"NOT_MEMBERS"},{"namespace":"France","role":"ISSUER","schema":{"ID":"Wine"},"who":"NOT_MEMBERS"},{"namespace":"Spain","role":"WITNESS","schema":{"ID":"Wine"},"who":{"NAME":"SFO"}},{"namespace":"Spain","role":"APPROVER","schema":{"ID":"Wine"},"who":{"NAME":"SFO"}}]}\'\n')),(0,o.kt)("p",null,"The result obtained will be:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'[\n    {\n        "op": "replace",\n        "path": "/roles/2/namespace",\n        "value": "Spain"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/3/namespace",\n        "value": "France"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/3/role",\n        "value": "CREATOR"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/3/schema/ID",\n        "value": "Wine"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/3/who/NAME",\n        "value": "PremiumWines"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/4/role",\n        "value": "APPROVER"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/5/role",\n        "value": "VALIDATOR"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/6/role",\n        "value": "EVALUATOR"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/6/schema/ID",\n        "value": "governance"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/7/namespace",\n        "value": "Spain"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/7/role",\n        "value": "WITNESS"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/7/who",\n        "value": {\n        "NAME": "WFO"\n        }\n    },\n    {\n        "op": "replace",\n        "path": "/roles/8/namespace",\n        "value": "France"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/8/who/NAME",\n        "value": "WFO"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/9/namespace",\n        "value": "Spain"\n    },\n    {\n        "op": "replace",\n        "path": "/roles/9/who/NAME",\n        "value": "WFO"\n    },\n    {\n        "op": "add",\n        "path": "/roles/10",\n        "value": {\n        "namespace": "France",\n        "role": "APPROVER",\n        "schema": {\n            "ID": "Wine"\n        },\n        "who": {\n            "NAME": "WFO"\n        }\n        }\n    },\n    {\n        "op": "add",\n        "path": "/roles/11",\n        "value": {\n        "namespace": "Spain",\n        "role": "ISSUER",\n        "schema": {\n            "ID": "Wine"\n        },\n        "who": "NOT_MEMBERS"\n        }\n    },\n    {\n        "op": "add",\n        "path": "/roles/12",\n        "value": {\n        "namespace": "France",\n        "role": "ISSUER",\n        "schema": {\n            "ID": "Wine"\n        },\n        "who": "NOT_MEMBERS"\n        }\n    },\n    {\n        "op": "add",\n        "path": "/roles/13",\n        "value": {\n        "namespace": "Spain",\n        "role": "WITNESS",\n        "schema": {\n            "ID": "Wine"\n        },\n        "who": {\n            "NAME": "SFO"\n        }\n        }\n    },\n    {\n        "op": "add",\n        "path": "/roles/14",\n        "value": {\n        "namespace": "Spain",\n        "role": "APPROVER",\n        "schema": {\n            "ID": "Wine"\n        },\n        "who": {\n            "NAME": "SFO"\n        }\n        }\n    }\n]\n')),(0,o.kt)("p",null,"Next, we will invoke the governance contract method responsible for updating its properties:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},'curl --request POST \'http://localhost:3000/api/event-requests\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n    "request": {\n        "Fact": {\n            "subject_id": {{GOVERNANCE-ID}},\n            "payload": {\n                "Patch": {\n                    "data": [\n                        {\n                            "op": "replace",\n                            "path": "/roles/2/namespace",\n                            "value": "Spain"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/3/namespace",\n                            "value": "France"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/3/role",\n                            "value": "CREATOR"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/3/schema/ID",\n                            "value": "Wine"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/3/who/NAME",\n                            "value": "PremiumWines"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/4/role",\n                            "value": "APPROVER"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/5/role",\n                            "value": "VALIDATOR"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/6/role",\n                            "value": "EVALUATOR"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/6/schema/ID",\n                            "value": "governance"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/7/namespace",\n                            "value": "Spain"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/7/role",\n                            "value": "WITNESS"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/7/who",\n                            "value": {\n                                "NAME": "WFO"\n                            }\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/8/namespace",\n                            "value": "France"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/8/who/NAME",\n                            "value": "WFO"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/9/namespace",\n                            "value": "Spain"\n                        },\n                        {\n                            "op": "replace",\n                            "path": "/roles/9/who/NAME",\n                            "value": "WFO"\n                        },\n                        {\n                            "op": "add",\n                            "path": "/roles/10",\n                            "value": {\n                                "namespace": "France",\n                                "role": "APPROVER",\n                                "schema": {\n                                    "ID": "Wine"\n                                },\n                                "who": {\n                                    "NAME": "WFO"\n                                }\n                            }\n                        },\n                        {\n                            "op": "add",\n                            "path": "/roles/11",\n                            "value": {\n                                "namespace": "Spain",\n                                "role": "ISSUER",\n                                "schema": {\n                                    "ID": "Wine"\n                                },\n                                "who": "NOT_MEMBERS"\n                            }\n                        },\n                        {\n                            "op": "add",\n                            "path": "/roles/12",\n                            "value": {\n                                "namespace": "France",\n                                "role": "ISSUER",\n                                "schema": {\n                                    "ID": "Wine"\n                                },\n                                "who": "NOT_MEMBERS"\n                            }\n                        },\n                        {\n                            "op": "add",\n                            "path": "/roles/13",\n                            "value": {\n                                "namespace": "Spain",\n                                "role": "WITNESS",\n                                "schema": {\n                                    "ID": "Wine"\n                                },\n                                "who": {\n                                    "NAME": "SFO"\n                                }\n                            }\n                        },\n                        {\n                            "op": "add",\n                            "path": "/roles/14",\n                            "value": {\n                                "namespace": "Spain",\n                                "role": "APPROVER",\n                                "schema": {\n                                    "ID": "Wine"\n                                },\n                                "who": {\n                                    "NAME": "SFO"\n                                }\n                            }\n                        }\n                    ]\n                }\n            }\n        }\n    }\n}\'\n')),(0,o.kt)("p",null,"After sending the governance update request, we will receive an approval notification. To do this, run the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},"curl --request GET 'http://localhost:3000/api/approval-requests?status=Pending'\n")),(0,o.kt)("p",null,"Copy the value of the ",(0,o.kt)("inlineCode",{parentName:"p"},"id")," field from the notification and request approval from ",(0,o.kt)("strong",{parentName:"p"},"WPO")," and ",(0,o.kt)("strong",{parentName:"p"},"WFO"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},"curl --request PATCH 'http://localhost:3000/api/approval-requests/{{PREVIUS-ID}}' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\"state\": \"RespondedAccepted\"}'\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WFO"',title:'"Node:','WFO"':!0},"curl --request PATCH 'http://localhost:3002/api/approval-requests/{{PREVIUS-ID}}' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\"state\": \"RespondedAccepted\"}'\n")),(0,o.kt)("p",null,"If everything went well, when you execute the following command, the governance ",(0,o.kt)("inlineCode",{parentName:"p"},"sn")," should be 7, and the changes made earlier should be displayed:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},"curl --request GET 'http://localhost:3000/api/subjects?subject_type=governances'\n")),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Click to look at the full governance."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "subject_id": {{GOVERNANCE-ID}},\n    "governance_id": "",\n    "sn": 7,\n    "public_key": "E8tVWEasubIp7P9fzk_HttNCsABymV9m9xEPAfr-QV7M",\n    "namespace": "",\n    "name": "wine_track",\n    "schema_id": "governance",\n    "owner": "EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs",\n    "creator": "EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs",\n    "properties": {\n        "members": [\n            {\n                "id": "EbwR0yYrCYpTzlN5i5GX_MtAbKRw5y2euv3TqiTgwggs",\n                "name": "WPO"\n            },\n            {\n                "id": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n                "name": "PremiumWines"\n            },\n            {\n                "id": "EICgJYOXXRFqDMiFsrCcUgPYnCSgUT-zwe66LP8rDpPU",\n                "name": "WFO"\n            },\n            {\n                "id": "EaHFQQ0ADaLuRgQsIZxYNU8BAj_cBub7MZdpoZsRf-GY",\n                "name": "SFO"\n            }\n        ],\n        "policies": [\n            {\n                "approve": {\n                    "quorum": "MAJORITY"\n                },\n                "evaluate": {\n                    "quorum": "MAJORITY"\n                },\n                "id": "governance",\n                "validate": {\n                    "quorum": "MAJORITY"\n                }\n            },\n            {\n                "approve": {\n                    "quorum": "MAJORITY"\n                },\n                "evaluate": {\n                    "quorum": "MAJORITY"\n                },\n                "id": "Wine",\n                "validate": {\n                    "quorum": "MAJORITY"\n                }\n            }\n        ],\n        "roles": [\n            {\n                "namespace": "",\n                "role": "WITNESS",\n                "schema": {\n                    "ID": "governance"\n                },\n                "who": "MEMBERS"\n            },\n            {\n                "namespace": "",\n                "role": "APPROVER",\n                "schema": {\n                    "ID": "governance"\n                },\n                "who": {\n                    "NAME": "WPO"\n                }\n            },\n            {\n                "namespace": "Spain",\n                "role": "CREATOR",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": {\n                    "NAME": "PremiumWines"\n                }\n            },\n            {\n                "namespace": "France",\n                "role": "CREATOR",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": {\n                    "NAME": "PremiumWines"\n                }\n            },\n            {\n                "namespace": "",\n                "role": "APPROVER",\n                "schema": {\n                    "ID": "governance"\n                },\n                "who": {\n                    "NAME": "WFO"\n                }\n            },\n            {\n                "namespace": "",\n                "role": "VALIDATOR",\n                "schema": {\n                    "ID": "governance"\n                },\n                "who": {\n                    "NAME": "WFO"\n                }\n            },\n            {\n                "namespace": "",\n                "role": "EVALUATOR",\n                "schema": {\n                    "ID": "governance"\n                },\n                "who": {\n                    "NAME": "WFO"\n                }\n            },\n            {\n                "namespace": "Spain",\n                "role": "WITNESS",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": {\n                    "NAME": "WFO"\n                }\n            },\n            {\n                "namespace": "France",\n                "role": "WITNESS",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": {\n                    "NAME": "WFO"\n                }\n            },\n            {\n                "namespace": "Spain",\n                "role": "APPROVER",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": {\n                    "NAME": "WFO"\n                }\n            },\n            {\n                "namespace": "France",\n                "role": "APPROVER",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": {\n                    "NAME": "WFO"\n                }\n            },\n            {\n                "namespace": "Spain",\n                "role": "ISSUER",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": "NOT_MEMBERS"\n            },\n            {\n                "namespace": "France",\n                "role": "ISSUER",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": "NOT_MEMBERS"\n            },\n            {\n                "namespace": "Spain",\n                "role": "WITNESS",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": {\n                    "NAME": "SFO"\n                }\n            },\n            {\n                "namespace": "Spain",\n                "role": "APPROVER",\n                "schema": {\n                    "ID": "Wine"\n                },\n                "who": {\n                    "NAME": "SFO"\n                }\n            }\n        ],\n        "schemas": [\n            {\n                "contract": {\n                    "raw": "dXNlIHRhcGxlX3NjX3J1c3QgYXMgc2RrOw0KdXNlIHNlcmRlOjp7RGVzZXJpYWxpemUsIFNlcmlhbGl6ZX07DQoNCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lLCBQYXJ0aWFsRXEpXSANCmVudW0gR3JhcGUgew0KICAgIENhYmVybmV0U2F1dmlnbm9uLA0KICAgIENoYXJkb25uYXksDQogICAgUGlub3ROb2lyLA0KfQ0KDQojW2Rlcml2ZShTZXJpYWxpemUsIERlc2VyaWFsaXplLCBDbG9uZSldDQpzdHJ1Y3QgVGVtcGVyYXR1cmVDb250cm9sIHsNCiAgICBwdWIgbGFzdF9jaGVjazogdTMyLA0KICAgIHB1YiB0ZW1wZXJhdHVyZV9vazogYm9vbCwNCn0NCg0KI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUpXQ0Kc3RydWN0IFN0YXRlIHsNCiAgICBwdWIgaGFydmVzdDogdTMyLA0KICAgIHB1YiBncmFwZTogT3B0aW9uPEdyYXBlPiwNCiAgICBwdWIgb3JpZ2luOiBTdHJpbmcsDQogICAgcHViIG9yZ2FuaWNfY2VydGlmaWVkOiBPcHRpb248Ym9vbD4sDQogICAgcHViIHRlbXBlcmF0dXJlX2NvbnRyb2w6IFRlbXBlcmF0dXJlQ29udHJvbCwNCn0NCg0KI1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSldDQplbnVtIFN0YXRlRXZlbnQgew0KICAgIEluaXQgew0KICAgICAgICBoYXJ2ZXN0OiB1MzIsDQogICAgICAgIGdyYXBlOiBTdHJpbmcsDQogICAgICAgIG9yaWdpbjogU3RyaW5nLA0KICAgIH0sDQogICAgVGVtcGVyYXR1cmVDb250cm9sIHsNCiAgICAgICAgdGVtcGVyYXR1cmU6IGYzMiwNCiAgICAgICAgdGltZXN0YW1wOiB1MzIsDQogICAgfSwNCiAgICBPcmdhbmljQ2VydGlmaWNhdGlvbiB7DQogICAgICAgIGZlcnRpbGl6ZXJzX2NvbnRyb2w6IGJvb2wsDQogICAgICAgIHBlc3RpY2lkZXNfY29udHJvbDogYm9vbCwNCiAgICAgICAgYW5hbHl0aWNzOiBib29sLA0KICAgICAgICBhZGRpdGlvbmFsX2luZm86IFN0cmluZywNCiAgICB9LA0KfQ0KDQpjb25zdCBURU1QRVJBVFVSRV9SQU5HRTogKGYzMiwgZjMyKSA9ICgxMC4wLCAxNi4wKTsNCg0KI1tub19tYW5nbGVdDQpwdWIgdW5zYWZlIGZuIG1haW5fZnVuY3Rpb24oc3RhdGVfcHRyOiBpMzIsIGV2ZW50X3B0cjogaTMyLCBpc19vd25lcjogaTMyKSAtPiB1MzIgew0KICAgIHNkazo6ZXhlY3V0ZV9jb250cmFjdChzdGF0ZV9wdHIsIGV2ZW50X3B0ciwgaXNfb3duZXIsIGNvbnRyYWN0X2xvZ2ljKQ0KfQ0KDQpmbiBjb250cmFjdF9sb2dpYygNCiAgICBjb250ZXh0OiAmc2RrOjpDb250ZXh0PFN0YXRlLCBTdGF0ZUV2ZW50PiwNCiAgICBjb250cmFjdF9yZXN1bHQ6ICZtdXQgc2RrOjpDb250cmFjdFJlc3VsdDxTdGF0ZT4sDQopIHsNCiAgICBsZXQgc3RhdGUgPSAmbXV0IGNvbnRyYWN0X3Jlc3VsdC5maW5hbF9zdGF0ZTsNCiAgICBtYXRjaCAmY29udGV4dC5ldmVudCB7DQogICAgICAgIFN0YXRlRXZlbnQ6OkluaXQgew0KICAgICAgICAgICAgaGFydmVzdCwNCiAgICAgICAgICAgIGdyYXBlLA0KICAgICAgICAgICAgb3JpZ2luLA0KICAgICAgICB9ID0+IHsNCiAgICAgICAgICAgIGlmIGNvbnRleHQuaXNfb3duZXIgJiYgIWNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlKSB7DQogICAgICAgICAgICAgICAgbGV0IGdyYXBlID0gbWF0Y2ggZ3JhcGUuYXNfc3RyKCkgew0KICAgICAgICAgICAgICAgICAgICAiQ2FiZXJuZXRTYXV2aWdub24iID0+IFNvbWUoR3JhcGU6OkNhYmVybmV0U2F1dmlnbm9uKSwNCiAgICAgICAgICAgICAgICAgICAgIkNoYXJkb25uYXkiID0+IFNvbWUoR3JhcGU6OkNoYXJkb25uYXkpLA0KICAgICAgICAgICAgICAgICAgICAiUGlub3ROb2lyIiA9PiBTb21lKEdyYXBlOjpQaW5vdE5vaXIpLA0KICAgICAgICAgICAgICAgICAgICBfID0+IE5vbmUsDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBpZiBncmFwZS5pc19zb21lKCkgew0KICAgICAgICAgICAgICAgICAgICBzdGF0ZS5oYXJ2ZXN0ID0gKmhhcnZlc3Q7DQogICAgICAgICAgICAgICAgICAgIHN0YXRlLmdyYXBlID0gZ3JhcGU7DQogICAgICAgICAgICAgICAgICAgIHN0YXRlLm9yaWdpbiA9IG9yaWdpbi50b19zdHJpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LnN1Y2Nlc3MgPSB0cnVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBTdGF0ZUV2ZW50OjpUZW1wZXJhdHVyZUNvbnRyb2wgew0KICAgICAgICAgICAgdGVtcGVyYXR1cmUsDQogICAgICAgICAgICB0aW1lc3RhbXAsDQogICAgICAgIH0gPT4gew0KICAgICAgICAgICAgaWYgY29udGV4dC5pc19vd25lciAmJiBjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZSkgew0KICAgICAgICAgICAgICAgIGlmIGNoZWNrX3RlbXBlcmF0dXJlX2luX3JhbmdlKCp0ZW1wZXJhdHVyZSkNCiAgICAgICAgICAgICAgICAgICAgJiYgc3RhdGUudGVtcGVyYXR1cmVfY29udHJvbC50ZW1wZXJhdHVyZV9vaw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgc3RhdGUudGVtcGVyYXR1cmVfY29udHJvbC5sYXN0X2NoZWNrID0gKnRpbWVzdGFtcDsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBzdGF0ZS50ZW1wZXJhdHVyZV9jb250cm9sLnRlbXBlcmF0dXJlX29rID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHN0YXRlLnRlbXBlcmF0dXJlX2NvbnRyb2wubGFzdF9jaGVjayA9ICp0aW1lc3RhbXA7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5zdWNjZXNzID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBTdGF0ZUV2ZW50OjpPcmdhbmljQ2VydGlmaWNhdGlvbiB7DQogICAgICAgICAgICBmZXJ0aWxpemVyc19jb250cm9sLA0KICAgICAgICAgICAgcGVzdGljaWRlc19jb250cm9sLA0KICAgICAgICAgICAgYW5hbHl0aWNzLA0KICAgICAgICAgICAgYWRkaXRpb25hbF9pbmZvLA0KICAgICAgICB9ID0+IHsNCiAgICAgICAgICAgIGlmIGNoZWNrX3N1YmplY3RfaGFzX2JlZW5faW5pdGlhdGVkKHN0YXRlKSB7DQogICAgICAgICAgICAgICAgbWF0Y2ggc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgew0KICAgICAgICAgICAgICAgICAgICBTb21lKG9yZ2FuaWNfY2VyaWZpZWQpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG9yZ2FuaWNfY2VyaWZpZWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhY2hlY2tfaXNfb3JnYW5pYygNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKmZlcnRpbGl6ZXJzX2NvbnRyb2wsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpwZXN0aWNpZGVzX2NvbnRyb2wsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICphbmFseXRpY3MsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLm9yZ2FuaWNfY2VydGlmaWVkID0gU29tZShmYWxzZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgTm9uZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBjaGVja19pc19vcmdhbmljKCpmZXJ0aWxpemVyc19jb250cm9sLCAqcGVzdGljaWRlc19jb250cm9sLCAqYW5hbHl0aWNzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUub3JnYW5pY19jZXJ0aWZpZWQgPSBTb21lKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZS5vcmdhbmljX2NlcnRpZmllZCA9IFNvbWUoZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGNvbnRyYWN0X3Jlc3VsdC5hcHByb3ZhbF9yZXF1aXJlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgY29udHJhY3RfcmVzdWx0LnN1Y2Nlc3MgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpmbiBjaGVja19zdWJqZWN0X2hhc19iZWVuX2luaXRpYXRlZChzdGF0ZTogJlN0YXRlKSAtPiBib29sIHsNCiAgICBsZXQgaW5pdGlhbF9ncmFwZSA9IG1hdGNoIHN0YXRlLmdyYXBlIHsNCiAgICAgICAgU29tZShfKSA9PiBmYWxzZSwNCiAgICAgICAgTm9uZSA9PiB0cnVlLA0KICAgIH07DQogICAgaWYgc3RhdGUuaGFydmVzdCA9PSAwICYmIGluaXRpYWxfZ3JhcGUgJiYgc3RhdGUub3JpZ2luID09IGZvcm1hdCEoIiIpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICByZXR1cm4gdHJ1ZTsNCn0NCg0KZm4gY2hlY2tfdGVtcGVyYXR1cmVfaW5fcmFuZ2UodGVtcGVyYXR1cmU6IGYzMikgLT4gYm9vbCB7DQogICAgaWYgdGVtcGVyYXR1cmUgPj0gVEVNUEVSQVRVUkVfUkFOR0UuMCAmJiB0ZW1wZXJhdHVyZSA8PSBURU1QRVJBVFVSRV9SQU5HRS4xIHsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIHJldHVybiBmYWxzZTsNCn0NCg0KZm4gY2hlY2tfaXNfb3JnYW5pYyhmZXJ0aWxpemVyc19jb250cm9sOiBib29sLCBwZXN0aWNpZGVzX2NvbnRyb2w6IGJvb2wsIGFuYWx5dGljczogYm9vbCkgLT4gYm9vbCB7DQogICAgaWYgZmVydGlsaXplcnNfY29udHJvbCAmJiBwZXN0aWNpZGVzX2NvbnRyb2wgJiYgYW5hbHl0aWNzIHsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIHJldHVybiBmYWxzZTsNCn0="\n                },\n                "id": "Wine",\n                "initial_value": {\n                    "grape": null,\n                    "harvest": 0,\n                    "organic_certified": null,\n                    "origin": "",\n                    "temperature_control": {\n                        "last_check": 0,\n                        "temperature_ok": true\n                    }\n                },\n                "schema": {\n                    "additionalProperties": false,\n                    "description": "Representation of a bottle of wine",\n                    "properties": {\n                        "grape": {\n                            "description": "Type of grape",\n                            "enum": [\n                                "CabernetSauvignon",\n                                "Chardonnay",\n                                "PinotNoir",\n                                null\n                            ],\n                            "type": [\n                                "string",\n                                "null"\n                            ]\n                        },\n                        "harvest": {\n                            "description": "Harvest number",\n                            "type": "integer"\n                        },\n                        "organic_certified": {\n                            "description": "Certificate authenticating whether it is organic or not",\n                            "type": [\n                                "boolean",\n                                "null"\n                            ]\n                        },\n                        "origin": {\n                            "description": "Origin of the grape",\n                            "type": "string"\n                        },\n                        "temperature_control": {\n                            "additionalProperties": false,\n                            "description": "Values to be changed in the temperature control event",\n                            "properties": {\n                                "last_check": {\n                                    "description": "Timestamp of last check",\n                                    "type": "integer"\n                                },\n                                "temperature_ok": {\n                                    "description": "Value that corroborates whether the wine cold chain has been complied with",\n                                    "type": "boolean"\n                                }\n                            },\n                            "required": [\n                                "last_check",\n                                "temperature_ok"\n                            ],\n                            "type": "object"\n                        }\n                    },\n                    "required": [\n                        "harvest",\n                        "grape",\n                        "origin",\n                        "organic_certified",\n                        "temperature_control"\n                    ],\n                    "type": "object"\n                }\n            }\n        ]\n    },\n    "active": true\n}\n'))),(0,o.kt)("p",null,"Once we have implemented ",(0,o.kt)("em",{parentName:"p"},"namespace")," segmentation, we will perform tests to verify its correct functioning."),(0,o.kt)("p",null,"Let's create a French wine bottle using the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Premium Wines"',title:'"Node:',Premium:!0,'Wines"':!0},'curl --request POST \'http://localhost:3001/api/event-requests\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n    "request": {\n        "Create": {\n        "governance_id": {{GOVERNANCE-ID}},\n        "schema_id": "Wine",\n        "namespace": "France",\n        "name": "Wine"\n        }\n    }\n}\'\n')),(0,o.kt)("p",null,"When you perform this action, you will receive a ",(0,o.kt)("inlineCode",{parentName:"p"},"request-id"),", which you should copy and use in the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Premium wines"',title:'"Node:',Premium:!0,'wines"':!0},"curl --request GET 'http://localhost:3001/api/event-requests/{{REQUEST-ID}}/state'\n")),(0,o.kt)("p",null,"This last command will give you a response similar to the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "id": {{REQUEST-ID}},\n    "subject_id": {{SUBJECT-ID}},\n    "sn": 0,\n    "state": "finished",\n    "success": true\n}\n')),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Save the ",(0,o.kt)("inlineCode",{parentName:"p"},"subject_id")," of the ",(0,o.kt)("strong",{parentName:"p"},"subject"),", as you will need it for subsequent steps in the tutorial.")),(0,o.kt)("p",null,"To check our new wine bottle, execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},"curl --request GET 'http://localhost:3001/api/subjects/{{SUBJECT-ID}}'\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "subject_id": {{SUBJECT-ID}},\n    "governance_id": {{GOVERNANCE-ID}},\n    "sn": 0,\n    "public_key": "E5DkRaljajwUZ1HrpgdkIxdTu0fbrg-nqoBJFHqm6GJY",\n    "namespace": "France",\n    "name": "Wine",\n    "schema_id": "Wine",\n    "owner": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n    "creator": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n    "properties": {\n        "grape": null,\n        "harvest": 0,\n        "organic_certified": null,\n        "origin": "",\n        "temperature_control": {\n            "last_check": 0,\n            "temperature_ok": true\n        }\n    },\n    "active": true\n}\n')),(0,o.kt)("p",null,"But if we execute:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WPO"',title:'"Node:','WPO"':!0},"curl --request GET 'http://localhost:3000/api/subjects/{{SUBJECT-ID}}'\n")),(0,o.kt)("p",null,"We get 404 arror because of the segmentation we have applied changing the namespace, which determine who are the witnesses of the subject."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Copy its ",(0,o.kt)("inlineCode",{parentName:"p"},"subject_id")," as it will be necessary for the following steps.")),(0,o.kt)("p",null,"Initialize the bottle before testing the certification event issuance:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Premium Wines"',title:'"Node:',Premium:!0,'Wines"':!0},'curl --request POST \'http://localhost:3001/api/event-requests\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n    "request": {\n        "Fact": {\n            "subject_id": {{SUBJECT-ID}},\n            "payload": {\n                "Init": {\n                    "harvest": 2,\n                    "grape": "Chardonnay",\n                    "origin": "france"\n                }\n            }\n        }\n    }\n}\'\n')),(0,o.kt)("p",null,"Now, when you execute the subject query again, it should have a ",(0,o.kt)("inlineCode",{parentName:"p"},"sn")," value of 1 and display the previously mentioned information:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Premium Wines"',title:'"Node:',Premium:!0,'Wines"':!0},"curl --request GET 'http://localhost:3001/api/subjects/{{SUBJECT-ID}}'\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "subject_id": {{SUBJECT-ID}},\n    "governance_id": {{GOVERNANCE-ID}},\n    "sn": 1,\n    "public_key": "E5DkRaljajwUZ1HrpgdkIxdTu0fbrg-nqoBJFHqm6GJY",\n    "namespace": "France",\n    "name": "Wine",\n    "schema_id": "Wine",\n    "owner": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n    "creator": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n    "properties": {\n        "grape": "Chardonnay",\n        "harvest": 2,\n        "organic_certified": null,\n        "origin": "france",\n        "temperature_control": {\n            "last_check": 0,\n            "temperature_ok": true\n        }\n    },\n    "active": true\n}\n')),(0,o.kt)("p",null,"We will test issuing the certification event. To do this, we will generate the event signature we want to issue using ",(0,o.kt)("a",{parentName:"p",href:"/taple-docsite/docs/learn/client-tools#taple-sign"},"TAPLE-Sign"),", with the following format, replacing ",(0,o.kt)("inlineCode",{parentName:"p"},"subject_id")," with the identifier of our wine subject:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Another terminal"',title:'"Another','terminal"':!0},'taple-sign \'f855c6736463a65f515afe7b85d1418c096ed73852b42bbe4c332eb43d532326\' \'{"Fact":{"subject_id":"{{SUBJECT-ID}}","payload":{"OrganicCertification":{"fertilizers_control":false,"pesticides_control":false,"analytics":false,"additional_info":"test"}}}}\'\n')),(0,o.kt)("p",null,"The result of this execution will be included in the following request:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Premium Wines"',title:'"Node:',Premium:!0,'Wines"':!0},"curl --request POST 'http://localhost:3001/api/event-requests' \\\n--header 'Content-Type: application/json' \\\n--data-raw {{SIGN-RESULT}}\n")),(0,o.kt)("p",null,"This will give us a result similar to the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Premium Wines"',title:'"Node:',Premium:!0,'Wines"':!0},'curl --request POST \'http://localhost:3001/api/event-requests\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n    "request": {\n        "Fact": {\n        "subject_id": {{SUBJECT-ID}},\n        "payload": {\n            "OrganicCertification": {\n            "additional_info": "test",\n            "analytics": false,\n            "fertilizers_control": false,\n            "pesticides_control": false\n            }\n        }\n        }\n    },\n    "signature": {\n        "signer": "EzzmRjc8CtjzHu3MKmuTgnmOTgrJlYZj1D2DCZ9nN7Vk",\n        "timestamp": 1689858060412988735,\n        "value": "SEiF6C6zhFxzxs56nY6vk4ySTl7zvpV2gExTiiGlbxKI-HVvizL6eYmjV9IjE8GJMzOIQkok8rUehRVK9cNgSfCg"\n    }\n}\'\n')),(0,o.kt)("p",null,"If the segmentation has been successfully applied, the approval message for this subject should only have been received by ",(0,o.kt)("strong",{parentName:"p"},"WFO"),". To check it, execute the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WFO"',title:'"Node:','WFO"':!0},"curl --request GET 'http://localhost:3002/api/approval-requests?status=pending'\n")),(0,o.kt)("p",null,"Copy its ",(0,o.kt)("inlineCode",{parentName:"p"},"id")," and use it to accept it with the following request:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: WFO"',title:'"Node:','WFO"':!0},"curl --request PATCH 'http://localhost:3002/api/approval-requests/{{PREVIUS-ID}}' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\"state\": \"RespondedAccepted\"}'\n")),(0,o.kt)("p",null,"Now, when you query the subject again, it should show a ",(0,o.kt)("inlineCode",{parentName:"p"},"sn")," value of 2, and the ",(0,o.kt)("inlineCode",{parentName:"p"},"organic_certified")," field should be ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Node: Premium Wines"',title:'"Node:',Premium:!0,'Wines"':!0},"curl --request GET 'http://localhost:3001/api/subjects?subject_type=all&governanceid={{GOVERNANCE-ID}}'\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "subject_id": {{SUBJECT_ID}},\n    "governance_id": {{GOVERNANCE_ID}},\n    "sn": 2,\n    "public_key": "E5DkRaljajwUZ1HrpgdkIxdTu0fbrg-nqoBJFHqm6GJY",\n    "namespace": "France",\n    "name": "Wine",\n    "schema_id": "Wine",\n    "owner": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n    "creator": "Ee-ZvImOQSgRBDR9XH0uQ5gbVv4828h_o5GuLbWFWaLI",\n    "properties": {\n        "grape": "Chardonnay",\n        "harvest": 2,\n        "organic_certified": false,\n        "origin": "france",\n        "temperature_control": {\n            "last_check": 0,\n            "temperature_ok": true\n        }\n    },\n    "active": true\n}\n')))}p.isMDXComponent=!0}}]);